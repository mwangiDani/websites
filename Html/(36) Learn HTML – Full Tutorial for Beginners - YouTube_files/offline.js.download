(function(g){var window=this;'use strict';var c4x=function(P){var v=new g.zc("und",new g.y5("Default","und",!0));v.captionTracks=P.captionTracks;return v},qtv=function(P){return new g.Jt(function(v,l){var e=P.length,h=[];
if(e)for(var z=function(y,C){e--;h[y]=C;e==0&&v(h)},m=function(y){l(y)},Q,t=0;t<P.length;t++)Q=P[t],g.PQu(Q,g.TW(z,t),m);
else v(h)})},BD=function(P){this.W=P},i8=function(){BD.apply(this,arguments)},F3v=function(){i8.apply(this,arguments)},A4Y=function(){i8.apply(this,arguments)},Yto=function(){i8.apply(this,arguments)},bIx=function(){i8.apply(this,arguments)},xly=function(){i8.apply(this,arguments)},p_o=function(){i8.apply(this,arguments)},L3Y=function(){BD.apply(this,arguments)},Sty=function(){i8.apply(this,arguments)},G7x=function(){i8.apply(this,arguments)},X_y=function(){i8.apply(this,arguments)},BF1=function(){i8.apply(this,
arguments)},iI1=function(){i8.apply(this,arguments)},Ulm=function(){i8.apply(this,arguments)},ZIA=function(){i8.apply(this,arguments)},j3o=function(){i8.apply(this,arguments)},aGy=function(){i8.apply(this,arguments)},HIy=function(){i8.apply(this,arguments)},Eu1=function(){i8.apply(this,arguments)},W3A=function(){i8.apply(this,arguments)},OIQ=function(){BD.apply(this,arguments)},ou3=function(){i8.apply(this,arguments)},s31=function(){i8.apply(this,arguments)},r43=function(){i8.apply(this,arguments)},
Mzj=function(){i8.apply(this,arguments)},TFo=function(){i8.apply(this,arguments)},Vzy=function(){i8.apply(this,arguments)},dlA=function(){i8.apply(this,arguments)},PIm=function(){i8.apply(this,arguments)},vYQ=function(){i8.apply(this,arguments)},lA1=function(){BD.apply(this,arguments)},eJd=function(){BD.apply(this,arguments)},hJ1=function(){BD.apply(this,arguments)},zJv=function(){i8.apply(this,arguments)},m$y=function(){i8.apply(this,arguments)},RJm=function(){i8.apply(this,arguments)},Q9v=function(){i8.apply(this,
arguments)},tjx=function(){i8.apply(this,arguments)},y7j=function(){i8.apply(this,arguments)},CIA=function(){i8.apply(this,arguments)},fA1=function(){i8.apply(this,arguments)},gYA=function(){i8.apply(this,arguments)},ktx=function(){i8.apply(this,arguments)},wN3=function(){i8.apply(this,arguments)},$$3=function(){i8.apply(this,arguments)},IAd=function(){i8.apply(this,arguments)},D$o=function(){i8.apply(this,arguments)},nYm=function(){i8.apply(this,arguments)},Nzo=function(){i8.apply(this,arguments)},
J7G=function(){i8.apply(this,arguments)},ujY=function(){i8.apply(this,arguments)},KWx=function(){i8.apply(this,arguments)},c7o=function(){i8.apply(this,arguments)},q3A=function(){i8.apply(this,arguments)},FWA=function(){i8.apply(this,arguments)},A7Y=function(){i8.apply(this,arguments)},Y3m=function(){i8.apply(this,arguments)},bJQ=function(){i8.apply(this,arguments)},x$A=function(){i8.apply(this,arguments)},pN1=function(){BD.apply(this,arguments)},LW3=function(){i8.apply(this,arguments)},S3y=function(){i8.apply(this,
arguments)},GtG=function(){i8.apply(this,arguments)},XNj=function(){i8.apply(this,arguments)},Bzj=function(){i8.apply(this,arguments)},iJm=function(){i8.apply(this,arguments)},U$x=function(){i8.apply(this,arguments)},ZJG=function(){i8.apply(this,arguments)},j9m=function(){i8.apply(this,arguments)},aAb=function(){i8.apply(this,arguments)},HJA=function(){i8.apply(this,arguments)},EYy=function(){i8.apply(this,arguments)},WWo=function(){i8.apply(this,arguments)},OJ3=function(){i8.apply(this,arguments)},
oYy=function(){i8.apply(this,arguments)},s9m=function(){i8.apply(this,arguments)},r7d=function(){i8.apply(this,arguments)},MjA=function(){i8.apply(this,arguments)},Tzo=function(){i8.apply(this,arguments)},Vj1=function(){i8.apply(this,arguments)},d$y=function(){i8.apply(this,arguments)},PLo=function(){i8.apply(this,arguments)},v8A=function(){i8.apply(this,arguments)},lDY=function(){i8.apply(this,arguments)},eHd=function(){i8.apply(this,arguments)},hHy=function(){i8.apply(this,arguments)},zHj=function(){i8.apply(this,
arguments)},mL3=function(){i8.apply(this,arguments)},RHj=function(){i8.apply(this,arguments)},QWy=function(P){P=P.key||P.id;
if(!P)throw Error("Entity key is missing");return P},tKy=function(){if(UQ)return UQ();
var P={};UQ=g.RO("PersistentEntityStoreDb",{Sq:(P.EntityStore={OW:1},P.EntityAssociationStore={OW:2},P),shared:!1,upgrade:function(v,l){l(1)&&g.Hh(g.Bh(v,"EntityStore",{keyPath:"key"}),"entityType","entityType");l(2)&&(v=g.Bh(v,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.Hh(v,"byParentEntityKey","parentEntityKey"),g.Hh(v,"byChildEntityKey","childEntityKey"))},
version:3});return UQ()},yxd=function(P){return g.Tz(tKy(),P)},CLG=function(P){return g.Tz((0,g.e5m)(),P)},Za=function(P){this.token=P},jk=function(P,v){v=v===void 0?{}:v;
g.Ph.call(this,g.h5Q[P],Object.assign({},{name:"PESEncoderError",type:P},v));this.type=P;this.level="WARNING";Object.setPrototypeOf(this,jk.prototype)},fDb=function(P){return new jk("WRONG_DATA_TYPE",{Ey:P})},g8x=function(P){return P instanceof Error?new jk("UNKNOWN_ENCODE_ERROR",{K8:P.message}):new jk("UNKNOWN_ENCODE_ERROR")},kXA=function(P){return P instanceof Error?new jk("UNKNOWN_DECODE_ERROR",{K8:P.message}):new jk("UNKNOWN_DECODE_ERROR")},wFA=function(P,v){P=P instanceof jk?P:v(P);
g.Zx(P);throw P;},$Lm=function(){},IDd=function(P,v,l){try{return P.G(v,l)}catch(e){wFA(e,g8x)}},DLv=function(P){P=(new TextEncoder).encode(P).subarray(0,16);
var v=new Uint8Array(16);v.set(P);return v},ax=function(P){this.W=P},Nsv=function(P){var v=n83[P];
if(v)return v;g.j4(new g.Ph("Entity model not found.",{entityType:P}))},Jxv=function(P,v){this.W=P;
this.K=v;this.G={}},KZb=function(P,v){a:{P=uS1(P.K,v.version);
try{var l=P.K(v.data,v.key);break a}catch(e){wFA(e,kXA)}l=void 0}return l},HD=function(P,v,l){return P.W.objectStore("EntityStore").get(v).then(function(e){if(e){if(l&&e.entityType!==l)throw Error("Incorrect entity type");
return KZb(P,e)}})},EQ=function(P,v,l){return l?(l=l.map(function(e){return HD(P,e,v)}),g.x6.all(l)):P.W.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(v)).then(function(e){return e.map(function(h){return KZb(P,h)})})},OQ=function(P,v,l){var e=QWy(v),h=uS1(P.K,1),z=Object.assign({},v);
return P.W.objectStore("EntityStore").get(e).then(function(m){if(m){if(m.entityType!==l)throw Error("Incorrect entity type");z.entityMetadata||(m=KZb(P,m),z.entityMetadata=m.entityMetadata)}}).then(function(){var m={key:e,
entityType:l,data:IDd(h,z,e),version:1};return g.x6.all([g.Z0(P.W.objectStore("EntityStore"),m),cxy(P,z,l)])}).then(function(){WD(P,e,l);
return e})},qJ3=function(P,v,l){v=v.map(function(e){return OQ(P,e,l)});
return g.x6.all(v)},ox=function(P,v,l){if(l==null?0:l.Ys){var e=new Set;
return FZy(P,v,e).then(function(){for(var z=[],m=g.N(e),Q=m.next();!Q.done;Q=m.next())z.push(ox(P,Q.value));return g.x6.all(z).then(function(){})})}var h=g.Ct(v).entityType;
return g.x6.all([P.W.objectStore("EntityStore").delete(v),Axx(P,v)]).then(function(){WD(P,v,h)})},YJv=function(P,v){return g.oG(P.W.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(v)},function(l){return g.x6.all([l.delete(),
Axx(P,l.cursor.primaryKey)]).then(function(){WD(P,l.cursor.primaryKey,v);return g.Wh(l)})})},bCG=function(P,v,l,e){var h=uS1(P.K,1);
return HD(P,v,e).then(function(z){if(z){z=g.Jf(z,l);var m={key:v,entityType:e,data:IDd(h,z,v),version:1};return g.x6.all([g.Z0(P.W.objectStore("EntityStore"),m),cxy(P,z,e)])}}).then(function(){WD(P,v,e);
return v})},WD=function(P,v,l){var e=P.G[l];
e||(e=new Set,P.G[l]=e);e.add(v)},xL1=function(P,v,l){var e=QWy(v);
l=Nsv(l);if(!l)return g.x6.resolve([]);l=new l(v);P=P.W.objectStore("EntityAssociationStore");v=[];l=g.N(l.K());for(var h=l.next();!h.done;h=l.next())v.push(g.Z0(P,{parentEntityKey:e,childEntityKey:h.value}));return g.x6.all(v).then(function(z){return z.map(function(m){return m[1]})})},Axx=function(P,v){return P.W.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(v))},cxy=function(P,v,l){var e=QWy(v);
return Axx(P,e).then(function(){return xL1(P,v,l)})},FZy=function(P,v,l){if(l.has(v))return g.x6.resolve(void 0);
l.add(v);return pFj(P,v).then(function(e){return P.W.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(v)).then(function(){return e})}).then(function(e){var h=g.x6.resolve(void 0);
e=g.N(e);for(var z=e.next(),m={};!z.done;m={e$:void 0},z=e.next())m.e$=z.value,h=h.then(function(Q){return function(){return FZy(P,Q.e$,l)}}(m));
return h}).then(function(){})},pFj=function(P,v){var l=P.W.objectStore("EntityAssociationStore");
return l.index("byParentEntityKey").getAll(IDBKeyRange.only(v)).then(function(e){var h=[];e=g.N(e);for(var z=e.next();!z.done;z=e.next())z=z.value,h.push(l.index("byChildEntityKey").getAll(z.childEntityKey));return g.x6.all(h)}).then(function(e){var h=[];
e=g.N(e);for(var z=e.next();!z.done;z=e.next())z=z.value,z.length===1&&h.push(z[0].childEntityKey);return h})},sQ=function(){},LZv=function(){this.W={};
this.W[0]=new sQ;if(!g.YN("aes_pes_encoder_killswitch")){var P=this.W;try{var v=g.vh();var l=DLv(v);var e=new ax(new g.AS(l),new g.FY(l))}catch(h){throw P=h instanceof Error?new jk("KEY_CREATION_FAILED",{K8:h.message}):new jk("KEY_CREATION_FAILED"),g.Zx(P),P;}P[1]=e}},uS1=function(P,v){v=v===void 0?0:v;
P=P.W[v];if(!P)throw v=new jk("INVALID_ENCODER_VERSION",{Ey:v}),g.Zx(v),v;return P},r2=function(P,v){g.U.call(this);
this.token=P;this.W=v;this.observers=[];P=new g.Uy.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.vh());P.onmessage=this.K.bind(this);this.channel=P},Mv=function(P,v,l){var e,h,z,m;
return g.p(function(Q){if(Q.W==1)return g.b(Q,yxd(P.token),2);if(Q.W!=3)return e=Q.K,g.b(Q,g.UP(e,["EntityStore","EntityAssociationStore"],v,function(t){h=new Jxv(t,P.W);return l(h)}),3);
z=Q.K;h&&(m=h.G,Object.keys(m).length>0&&(P.channel.postMessage(m),SJA(P,m)));return Q.return(z)})},Ts=function(P,v,l){return Mv(P,{mode:"readwrite",
V7:!0},function(e){return OQ(e,v,l)})},GXx=function(P,v){return Mv(P,{mode:"readwrite",
V7:!0},function(l){return qJ3(l,v,"offlineOrchestrationActionWrapperEntity")})},XF1=function(P,v){return Mv(P,{mode:"readwrite",
V7:!0},function(l){return ox(l,v)})},Bs1=function(P){return Mv(P,{mode:"readwrite",
V7:!0},function(v){return YJv(v,"videoPlaybackPositionEntity")})},V6=function(P,v,l){return Mv(P,{mode:"readonly",
V7:!0},function(e){return HD(e,v,l)})},d2=function(P,v,l){return Mv(P,{mode:"readonly",
V7:!0},function(e){return EQ(e,v,l)})},SJA=function(P,v){P=g.N(P.observers);
for(var l=P.next();!l.done;l=P.next())l=l.value,l(v)},iCo=function(){var P,v,l;
return g.p(function(e){if(e.W==1)return g.NP(e,2),g.b(e,g.zJ(),4);if(e.W!=2){P=e.K;if(!P||!g.lH()||typeof g.Uy.BroadcastChannel==="undefined")return e.return();v=new LZv;return e.return(new r2(P,v))}l=g.Kx(e);l instanceof Error&&g.Zx(l);return e.return()})},Pc=function(){UL3||(UL3=iCo());
return UL3},ZCb=function(P){var v;
P=(v=P.options)==null?void 0:v.persistenceOption;return P==="ENTITY_PERSISTENCE_OPTION_PERSIST"||P==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},jWy=function(P){var v;
return g.p(function(l){return l.W==1?g.b(l,Pc(),2):(v=l.K)?g.b(l,Mv(v,"readwrite",function(e){for(var h={},z=g.N(P),m=z.next(),Q={};!m.done;Q={t1:void 0,mI:void 0},m=z.next())Q.t1=m.value,Q.t1.entityKey&&ZCb(Q.t1)&&(Q.mI=g.qT(Q.t1.payload),m=void 0,Q.t1.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(m=function(t){return function(){return OQ(e,t.t1.payload[t.mI],t.mI)}}(Q)),Q.t1.type==="ENTITY_MUTATION_TYPE_DELETE"&&(m=function(t){return function(){return ox(e,t.t1.entityKey)}}(Q)),Q.t1.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(m=function(t){return function(){return bCG(e,t.t1.entityKey,t.t1.payload[t.mI],t.mI)}}(Q)),m&&(h[Q.t1.entityKey]=h[Q.t1.entityKey]?h[Q.t1.entityKey].then(m):m()));
return g.x6.all(Object.values(h))}),0):l.return()})},aDx=function(P){var v;
return g.p(function(l){if(l.W==1){v=P.mutations;if(!v||v.length<=0)return l.return();if(g.z6){var e={type:"ENTITY_LOADED"};v!==void 0&&(e.payload=v);g.z6.dispatch(e)}return g.b(l,jWy(v),2)}v.length=0;g.nx(l)})},HC3=function(P){return P!==void 0},E8v=function(P){var v=g.p_();
v=Object.assign({},v);P=Object.assign({},P);for(var l in v)P[l]?(v[l]!==4&&(v[l]=P[l]),delete P[l]):v[l]!==2&&(v[l]=4);Object.assign(v,P);g.s2y(v);JSON.stringify(v);return v},WZy=function(P){var v,l;
return g.p(function(e){if(e.W==1)return g.b(e,g.zJ(),2);if(e.W!=3)return(v=e.K)?g.b(e,g.Gk(v),3):e.return();l=e.K;return e.return(g.UP(l,["index","media","captions"],{mode:"readwrite",V7:!0},function(h){var z=IDBKeyRange.bound(P+"|",P+"~");h=[h.objectStore("index").delete(z),h.objectStore("media").delete(z),h.objectStore("captions").delete(z)];return g.x6.all(h).then(function(){})}))})},OCy=function(){var P,v;
return g.p(function(l){if(l.W==1)return g.b(l,g.zJ(),2);if(l.W!=3){P=l.K;if(!P)throw g.Y6("rvdfd");return g.b(l,g.Gk(P),3)}v=l.K;return l.return(g.UP(v,["index","media"],{mode:"readwrite",V7:!0},function(e){var h={};return g.EP(e.objectStore("index"),{},function(z){var m=z.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),Q=g.x6.resolve(void 0);if(m){var t=m[1];m=m[2];h[t]=h[t]||{};var y;h[t][m]=g.di9((y=z.getValue())==null?void 0:y.fmts)}else Q=z.delete().then(function(){});
return g.x6.all([g.Wh(z),Q]).then(function(C){return g.N(C).next().value})}).then(function(){for(var z={},m=g.N(Object.keys(h)),Q=m.next();!Q.done;Q=m.next()){Q=Q.value;
var t=h[Q].v;z[Q]=h[Q].a&&t?1:2}var y=E8v(z);return g.S7w(e.objectStore("media"),{},function(C){var f=C.cursor.key.match(g.eAw);f&&z[f[1]]||e.objectStore("media").delete(C.cursor.key);return g.c8D(C)}).then(function(){return y})})}))})},o8Y=function(P,v){var l,e;
return g.p(function(h){if(h.W==1)return g.b(h,g.zJ(),2);if(h.W!=3){l=h.K;if(!l)throw g.Y6("wct");return g.b(h,g.Gk(l),3)}e=h.K;return g.b(h,g.UP(e,["captions"],{mode:"readwrite",V7:!0},function(z){var m=[];z=z.objectStore("captions");for(var Q=0;Q<v.length;Q++){var t=g.Z0(z,v[Q],P+"|"+v[Q].metadata.vss_id);m.push(t)}return g.x6.all(m)}),0)})},sWv=function(P){var v,l,e;
return g.p(function(h){if(h.W==1)return v=IDBKeyRange.bound(P+"|",P+"~"),g.b(h,g.zJ(),2);if(h.W!=3){l=h.K;if(!l)throw g.Y6("gactfv");return g.b(h,g.Gk(l),3)}e=h.K;return h.return(e.getAll("captions",v))})},rx3=function(P){return g.p(function(v){g.S0(P,0);
return v.return(WZy(P))})},MKQ=function(P){return{context:g.lo(),
videoIds:P}},Ts1=function(P){return{context:g.lo(),
playlistIds:P}},VKo=function(P){return{context:g.lo(),
offlinePlaylistSyncChecks:P}},dLj=function(){this.W=new Map},v1y=function(){PBy||(PBy=new dLj);
return PBy},lOy=function(P,v){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:P},metadata:v,statusCode:void 0,csn:void 0,can:void 0}},ei1=function(P,v,l){if(!l){var e=e===void 0?!1:e;
l=P.W.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!l||e)l=g.YR(16),P.W.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",l)}P={flowNonce:l,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:v.eventType};v.metadata&&(P.flowMetadata=v.metadata);v.statusCode!==void 0&&(P.flowEventStatus=v.statusCode);v.csn&&(P.csn=v.csn);v.can&&(P.can=v.can);g.$6("flowEvent",P,void 0)},hio=function(P){var v,l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y;
return g.p(function(L){if(L.W==1)return g.b(L,Mv(P,{mode:"readonly",V7:!0},function(X){return EQ(X,"playbackData").then(function(lD){var zW=lD.map(function($a){return $a.transfer}).filter(function($a){return!!$a}),mD=lD.map(function($a){return $a.offlineVideoPolicy}).filter(function($a){return!!$a}),G=lD.filter(function($a){return!!$a.key}).map(function($a){return g.ft(g.Ct($a.key).entityId,"downloadStatusEntity")});
zW=EQ(X,"transfer",zW);mD=EQ(X,"offlineVideoPolicy",mD);G=EQ(X,"downloadStatusEntity",G);var Cx=zW.then(function($a){$a=$a.reduce(function(tq,px){(px==null?0:px.offlineVideoStreams)&&tq.push.apply(tq,g.u(px.offlineVideoStreams));return tq},[]).filter(function(tq){return!!tq});
return EQ(X,"offlineVideoStreams",$a)});
return g.x6.all([zW,mD,Cx,G]).then(function($a){var tq=g.N($a);$a=tq.next().value;var px=tq.next().value;var go=tq.next().value;tq=tq.next().value;return[lD,$a,px,go,tq]})})}),2);
if(L.W!=3)return v=L.K,g.b(L,Mv(P,{mode:"readonly",V7:!0},function(X){return EQ(X,"mainDownloadsListEntity").then(function(lD){var zW,mD;return(mD=(zW=lD[0])==null?void 0:zW.downloads)!=null?mD:[]})}),3);
l=L.K;e=g.N(v);h=e.next().value;z=e.next().value;m=e.next().value;Q=e.next().value;t=e.next().value;y=h;C=z;f=m;k=Q;w=t;I={};J={};K={};q={};A={};x=[];S=g.N(C);for(B=S.next();!B.done;B=S.next())(E=B.value)&&(I[E.key]=E);r=g.N(f);for(hq=r.next();!hq.done;hq=r.next())(R7=hq.value)&&(J[R7.key]=R7);Pw=g.N(w);for(H=Pw.next();!H.done;H=Pw.next())(T=H.value)&&(K[T.key]=T);n=g.N(k);for(W=n.next();!W.done;W=n.next())(du=W.value)&&(q[du.key]=du);K1=g.N(l);for(f1=K1.next();!f1.done;f1=K1.next())Aq=f1.value,MP=
void 0,A[(MP=Aq.videoItem)!=null?MP:""]=!0,Aq.videoItem&&($3=lY=void 0,c=($3=(lY=g.Ct(Aq.videoItem))==null?void 0:lY.entityId)!=null?$3:"",x.push({externalVideoId:c}));F=y.filter(function(X){if(!X||!X.key||!X.offlineVideoPolicy)return!1;X=g.Ct(X.key).entityId;X=g.ft(X,"downloadStatusEntity");var lD;return!(X&&((lD=K[X])==null?void 0:lD.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
Y=F.map(function(X){var lD=I[X.transfer],zW=[];if(lD==null?0:lD.offlineVideoStreams)for(var mD=g.N(lD.offlineVideoStreams),G=mD.next();!G.done;G=mD.next())(G=q[G.value])&&zW.push(G);mD=J[X.offlineVideoPolicy];G=A;var Cx=X==null?void 0:X.playerResponseTimestamp,$a=g.Ct(mD.key).entityId;X=g.ft($a,"mainVideoEntity");if(mD.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var tq="OFFLINE_VIDEO_STATE_DISABLED";mD.expirationTimestamp&&Number(mD.expirationTimestamp)<Date.now()/1E3&&(tq="OFFLINE_VIDEO_STATE_EXPIRED")}else if(mD.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")tq="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(lD==null?void 0:lD.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":tq="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":tq="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":tq="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":tq="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":tq="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":tq="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:tq="OFFLINE_VIDEO_STATE_UNKNOWN"}if(tq==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(lD==null?void 0:lD.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":tq="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":tq="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":tq=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}$a={id:$a,videoState:tq};if(lD==null?0:lD.cotn)$a.cotn=lD.cotn;if(lD==null?0:lD.maximumDownloadQuality)$a.selectedVideoQuality=lD==null?void 0:lD.maximumDownloadQuality;if(lD==null?0:lD.lastProgressTimeMs)$a.lastProgressTimeMs=lD.lastProgressTimeMs;Cx&&($a.playerResponseSavedTimeMs=String(Number(Cx)*1E3));lD=String;Cx=0;zW=g.N(zW);for(tq=zW.next();!tq.done;tq=zW.next())if(tq=tq.value,tq.streamsProgress){tq=g.N(tq.streamsProgress);for(var px=tq.next();!px.done;px=
tq.next()){var go=void 0;Cx+=Number((go=px.value.numBytesDownloaded)!=null?go:0)}}$a.downloadedBytes=lD(Cx);$a.selectedOfflineMode=G[X]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";mD.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&($a.offlinePlaybackDisabledReason=mD.offlinePlaybackDisabledReason);return $a});
return L.return({offlineVideos:Y,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:x}}})})},zim=function(){this.locks=navigator.locks},m_j=function(){try{var P=g.j9("ytglobal.locks_");
if(P)return P;var v;if(v=navigator){var l=navigator;v="locks"in l&&!!l.locks}if(v)return g.Uy.localStorage&&g.Uy.localStorage.getItem("noop"),P=new zim,g.ZB("ytglobal.locks_",P),P}catch(e){}},vc=function(){},Rix=function(){},QFb=function(P){if(P.includes(":"))throw Error("Invalid user cache name: "+P);
return P+":"+g.vh("CacheStorage get")},t8d=function(){return g.p(function(P){if(lw!==void 0)return P.return(lw);
lw=new Promise(function(v){var l;return g.p(function(e){switch(e.W){case 1:return g.NP(e,2),g.b(e,eo.open("test-only"),4);case 4:return g.b(e,eo.delete("test-only"),5);case 5:g.uD(e,3);break;case 2:if(l=g.Kx(e),l instanceof Error&&l.name==="SecurityError")return v(!1),e.return();case 3:v("caches"in window),g.nx(e)}})});
return P.return(lw)})},CBy=function(){return g.p(function(P){if(P.W==1)return g.b(P,t8d(),2);
if(!P.K)return P.return(void 0);yvy||(yvy=new Rix);return P.return(yvy)})},h1=function(P,v,l){g.j4(new g.Ph("Woffle: "+P,l?{cotn:l}:""));
v instanceof Error&&g.j4(v)},fO3=function(P){var v;
return g.p(function(l){if(l.W==1)return g.b(l,hio(P),2);v=l.K;g.$6("offlineStateSnapshot",v);g.nx(l)})},zC=function(P){g.U.call(this);
var v=this;this.api=P;this.Kh={GIc:function(){return v.W},
PT$:function(){return v.K}};
typeof g.Uy.BroadcastChannel!=="undefined"&&(this.W=new g.Uy.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.vh()),this.W.onmessage=this.G.bind(this),this.K=new g.Uy.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.vh()),this.K.onmessage=this.Y.bind(this))},ma=function(P,v){P.api.C0("onOfflineOperationFailure",v);
var l;(l=P.W)==null||l.postMessage(v)},g1y=function(P,v,l,e){var h=this;
this.S=P;this.X=v;this.visibility=l;this.V=e;this.Z=this.j=this.T=this.G=this.W=!1;this.Y=new g.mr(function(){h.Oz()});
this.Kh={rU:function(){return h.K},
Oz:function(){h.Oz()},
qdc:function(){return h.Y}};
this.visibility.subscribe("visibilitystatechange",function(){h.Nv()})},kUj=function(P){if(!P.G&&!P.W){var v=m_j();
if(v){P.G=!0;var l=g.vh("OfflineLockManager");v.request("woffle_orchestration_leader:"+l,{},function(){var e,h,z,m;return g.p(function(Q){switch(Q.W){case 1:return g.NP(Q,2),P.K=new g.J4,P.W=!0,P.G=!1,g.b(Q,P.S(),4);case 4:return g.b(Q,P.K.promise,5);case 5:g.uD(Q,0);break;case 2:e=g.Kx(Q),((z=(h=P).V)==null?0:z.call(h,"wo_relinquish_leadership_on_lock_request_error"))||P.Oz(),e instanceof Error&&(m=e,m.args=[{name:"WoLockManagerError",zH:e.name}],g.Zx(m)),g.nx(Q)}})})}}},wk1=function(P){P.W&&(P.Z=
!0,Rl(P))},$_y=function(P,v){P.W&&(P.T=v,Rl(P))},IOb=function(P,v){P.W&&(P.j=v,Rl(P))},Rl=function(P){P.j&&P.T&&P.Z&&P.visibility.isBackground()?g.RX(P.Y,6E4):P.Y.stop()},QZ=function(P){var v;
P.offlineDeleteReason=(v=P.offlineDeleteReason)!=null?v:"OFFLINE_DELETE_REASON_UNKNOWN";var l;P.offlineModeType=(l=P.offlineModeType)!=null?l:"OFFLINE_NOW";g.$6("offlineDeleteEvent",P)},t1=function(P,v){var l=v.videoId;
var e=v.qj;v=v.offlineModeType;P.encryptedVideoId=l;P.cotn=e==null?void 0:e.cotn;P.offlineabilityFormatType=e==null?void 0:e.maximumDownloadQuality;var h;P.isRefresh=(h=e==null?void 0:e.isRefresh)!=null?h:!1;var z;P.softErrorCount=(z=e==null?void 0:e.transferRetryCount)!=null?z:0;P.offlineModeType=v!=null?v:"OFFLINE_NOW";(P.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&P.statusType==="UNKNOWN_STATUS_TYPE"||!P.transferStatusType&&!P.statusType)&&g.j4(Error("Woffle unknown transfer status"));
g.$6("offlineTransferStatusChanged",P)},D_b=function(P,v,l,e){e={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!e};v&&l&&(v=Math.floor(v/1024).toFixed(),l=Math.floor(l/1024).toFixed(),e.alreadyDownloadedKbytes=v,e.totalFetchedKbytes=v,e.totalContentKbytes=l);t1(e,P)},n1A=function(P){t1({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},P)},N1v=function(P){switch(P){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
yZ=function(P){var v,l,e;
return((e=(v=P.actionMetadata)==null?void 0:(l=v.retryScheduleIntervalsInSeconds)==null?void 0:l.length)!=null?e:0)>0},CA=function(P){return P.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!P.entityKey},fA=function(P){return P.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!P.entityKey},gv=function(P){return P.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!P.entityKey},JvA=function(P){return P.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!P.entityKey},
kp=function(P,v,l,e,h){h=h===void 0?!1:h;
var z,m,Q,t,y,C;return g.p(function(f){if(f.W==1)return z=g.ft(P,v),m=g.ft(P,"downloadStatusEntity"),g.b(f,Mv(l,{mode:"readonly",V7:!0},function(k){return g.x6.all([HD(k,z,v),HD(k,m,"downloadStatusEntity")])}),2);
Q=f.K;t=Q.length?Q[0]:void 0;if(!t)return f.ac(0);y=um1;if(C=Q.length>1?Q[1]:void 0){if(C.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!h)return f.return();C.downloadState=e}else C={key:m,downloadState:e};g.Oc(t,y,C);return g.b(f,Mv(l,{mode:"readwrite",V7:!0},function(k){return g.x6.all([OQ(k,t,v),OQ(k,C,"downloadStatusEntity")])}),0)})},wv=function(P,v){return P.actionType===v.actionType&&P.entityKey===v.entityKey},$p=function(P,v){if(P&&P.transferState!=="TRANSFER_STATE_COMPLETE"&&P.transferState!==
"TRANSFER_STATE_FAILED"){var l=g.Ct(P.key).entityId;
t1({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:l,qj:P,offlineModeType:v})}},Il=function(P){if(!P||!P.thumbnails)return[];
var v=[];P=g.N(P.thumbnails);for(var l=P.next();!l.done;l=P.next())l=l.value,l.url&&v.push(l.url);return v},Kwb=function(P,v,l){l=l===void 0?[]:l;
var e,h,z,m,Q,t,y,C,f,k,w,I,J;return g.p(function(K){if(K.W==1)return l.length?g.b(K,d2(P,v),2):K.return([]);e=K.K;h=new Set;z=g.N(e);for(m=z.next();!m.done;m=z.next())if(Q=m.value,t=Q.id||Q.key)y=g.Ct(t).entityId,h.add(y);C=[];f=g.N(l);for(k=f.next();!k.done;k=f.next())w=k.value,I=w.offlineVideoData,J=void 0,((J=I)==null?0:J.videoId)&&!h.has(I.videoId)&&C.push(w);return K.return(C)})},cvd=function(P,v,l){return new g.oI(P,{cotn:v,
raw_player_response:l,download_media:!0,start:Infinity,disable_watch_next:!0})},qmQ=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},DK=function(P,v,l,e,h,z,m,Q,t,y,C){this.entityType=P;
this.actionId=v;this.action=l;this.parentActionId=e;this.rootActionId=h===void 0?v:h;this.childActionIds=z;this.prereqActionId=m;this.postreqActionIds=Q;this.hasChildActionFailed=y;this.retryScheduleIndex=0;this.W=C||Date.now();this.retryScheduleIndex=t||0},nA=function(P){if(!P.key)throw Error("Entity key is required.");
if(!P.actionProto)throw Error("OfflineOrchestrationAction is required.");var v=g.Ct(P.key),l=g.Ct(P.actionProto.entityKey);return new DK(l.entityType,v.entityId,P.actionProto,P.parentActionId,P.rootActionId,P.childActionIds,P.prereqActionId,P.postreqActionIds,P.retryScheduleIndex,P.hasChildActionFailed,Number(P.enqueueTimeSec)*1E3)},Nq=function(P){return{key:g.ft(P.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:P.action,parentActionId:P.parentActionId,rootActionId:P.rootActionId,childActionIds:P.childActionIds,prereqActionId:P.prereqActionId,postreqActionIds:P.postreqActionIds,retryScheduleIndex:P.retryScheduleIndex,hasChildActionFailed:P.hasChildActionFailed,enqueueTimeSec:(P.W/1E3).toFixed()}},Fwx=function(){var P;
return g.p(function(v){return v.W==1?g.b(v,CBy(),2):(P=v.K)?v.return(P.delete("yt-player-local-img")):v.return(!0)})},J1=function(P){var v,l;
return g.p(function(e){if(e.W==1)return g.b(e,CBy(),2);if(e.W!=3){v=e.K;if(!v)throw Error("Cache API not supported");return P.length?g.b(e,v.open("yt-player-local-img"),3):e.return()}l=e.K;return g.b(e,Promise.all(P.map(function(h){return l.delete(h)})),0)})},uw=function(P){var v,l;
return g.p(function(e){if(e.W==1)return g.b(e,CBy(),2);if(e.W!=3){v=e.K;if(!v)throw Error("Cache API not supported");return P.length?g.b(e,v.open("yt-player-local-img"),3):e.return()}l=e.K;return g.b(e,l.addAll(P),0)})},KA=function(P,v,l,e,h){var z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP;
return g.p(function(lY){switch(lY.W){case 1:return z=g.ft(P,"mainVideoEntity"),m=g.ft(P,"ytMainChannelEntity"),Q=g.ft(P,"transfer"),t=g.ft(P,"videoDownloadContextEntity"),g.b(lY,Mv(v,{mode:"readonly",V7:!0},function($3){return g.x6.all([HD($3,z,"mainVideoEntity"),HD($3,m,"ytMainChannelEntity"),HD($3,Q,"transfer"),HD($3,t,"videoDownloadContextEntity"),EQ($3,"ytMainChannelEntity"),EQ($3,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:y=lY.K;C=g.N(y);f=C.next().value;k=C.next().value;w=C.next().value;I=C.next().value;J=C.next().value;K=C.next().value;q=f;A=k;x=w;S=I;B=J;E=K;if(!q&&!A){lY.ac(3);break}r=q?Il(q.thumbnail):[];if(!A){hq=[];lY.ac(4);break}return g.b(lY,AvQ(A,B),5);case 5:hq=lY.K;case 4:return R7=hq,g.b(lY,J1(r.concat(R7)),3);case 3:Pw=[];H=g.ft(P,"downloadStatusEntity");T=g.N(E);for(n=T.next();!n.done;n=T.next())W=n.value,du=g.Ct(W.key).entityId,K1=nA(W),f1=g.Ct(K1.action.entityKey).entityId,du!==P&&f1!==P||wv(l,
W.actionProto)||Pw.push(W.key);return g.b(lY,Mv(v,{mode:"readwrite",V7:!0},function($3){var c=Pw.map(function(F){return ox($3,F)});
c.push(ox($3,z,{Ys:!0}));c.push(ox($3,H,{Ys:!0}));return g.x6.all(c)}),7);
case 7:MP=(Aq=S)==null?void 0:Aq.offlineModeType,h&&(QZ(h),h.offlineModeType&&(MP=h.offlineModeType)),$p(x,MP),ma(e,{entityKey:z,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.nx(lY)}})},x_m=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y,L,X,lD,zW,mD,G,Cx,$a,tq,px,go,jx,kw;
return g.p(function(Ey){switch(Ey.W){case 1:return h=g.ft(P,"mainPlaylistEntity"),z=g.ft(P,"ytMainChannelEntity"),g.b(Ey,Mv(v,{mode:"readonly",V7:!0},function(Z7){return g.x6.all([HD(Z7,h,"mainPlaylistEntity"),HD(Z7,z,"ytMainChannelEntity"),EQ(Z7,"mainPlaylistEntity"),EQ(Z7,"mainDownloadsListEntity"),EQ(Z7,"ytMainChannelEntity"),EQ(Z7,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:m=Ey.K;Q=g.N(m);t=Q.next().value;y=Q.next().value;C=Q.next().value;f=Q.next().value;k=Q.next().value;w=Q.next().value;I=t;J=y;K=C;q=f;A=k;x=w;if(!I&&!J){Ey.ac(3);break}S=I?Ymm(I):[];if(!J){B=[];Ey.ac(4);break}return g.b(Ey,AvQ(J,A),5);case 5:B=Ey.K;case 4:return E=B,g.b(Ey,J1(S.concat(E)),3);case 3:r=[];hq=new Map;if(!I){Ey.ac(7);break}return g.b(Ey,bn3(I,K,q),8);case 8:r=Ey.K;R7=g.N(r);for(Pw=R7.next();!Pw.done;Pw=R7.next())H=Pw.value,hq.set(H,{videoId:H,playlistId:P,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.b(Ey,Mv(v,{mode:"readonly",V7:!0},function(Z7){return g.x6.all([EQ(Z7,"transfer"),EQ(Z7,"videoDownloadContextEntity")])}),9);
case 9:T=Ey.K;n=g.N(T);W=n.next().value;du=n.next().value;K1=W;f1=du;Aq=g.N(K1);for(MP=Aq.next();!MP.done;MP=Aq.next())lY=MP.value,$3=g.Ct(lY.key).entityId,(c=hq.get($3))&&lY&&(c.cotn=lY.cotn);F=g.N(f1);for(Y=F.next();!Y.done;Y=F.next())L=Y.value,X=g.Ct(L.key).entityId,(lD=hq.get(X))&&L&&(lD.offlineModeType=L.offlineModeType);case 7:zW=[];mD=g.N(x);for(G=mD.next();!G.done;G=mD.next())Cx=G.value,$a=g.Ct(Cx.key).entityId,tq=nA(Cx),$a!==P&&tq.rootActionId!==P||wv(l,Cx.actionProto)||zW.push(Cx.key);px=
g.ft(P,"mainPlaylistEntity");return g.b(Ey,Mv(v,{mode:"readwrite",V7:!0},function(Z7){var ya=zW.map(function(St){return ox(Z7,St)});
ya.push(ox(Z7,px,{Ys:!0}));return g.x6.all(ya)}),10);
case 10:if(!I){Ey.ac(0);break}r.reverse();if(!r){Ey.ac(0);break}go=g.N(r);jx=go.next();case 13:if(jx.done){Ey.ac(0);break}kw=jx.value;return g.b(Ey,KA(kw,v,l,e,hq.get(kw)),14);case 14:jx=go.next(),Ey.ac(13)}})},LwA=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k;
return g.p(function(w){if(w.W==1)return h=g.ft("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),z=new Map,g.b(w,Mv(P,{mode:"readwrite",V7:!0},function(I){var J=EQ(I,"transfer"),K=EQ(I,"offlineOrchestrationActionWrapperEntity"),q=EQ(I,"videoDownloadContextEntity"),A=HD(I,h,"mainDownloadsListEntity");return g.x6.all([J,K,q,A]).then(function(x){x=g.N(x);var S=x.next().value;var B=x.next().value;var E=x.next().value;var r=x.next().value;x=pkd.map(function(R7){return YJv(I,R7)});
B=g.N(B);for(var hq=B.next();!hq.done;hq=B.next())hq=hq.value,wv(v,hq.actionProto)||x.push(ox(I,hq.key,{Ys:!0}));r&&(r.downloads=[],x.push(OQ(I,r,"mainDownloadsListEntity")));if(E)for(E=g.N(E),r=E.next();!r.done;r=E.next())r=r.value,B=g.Ct(r.key).entityId,B=g.ft(B,"transfer"),z.set(B,r.offlineModeType);return g.x6.all(x).then(function(){return S})})}),2);
m=w.K;Q=g.N(m);for(t=Q.next();!t.done;t=Q.next())y=t.value,$p(y,z.get(y.key)),C=g.Ct(y.key).entityId,f={videoId:C,offlineDeleteReason:e,cotn:y.cotn,offlineModeType:z.get(y.key)},QZ(f),k=g.ft(C,"mainVideoEntity"),ma(l,{entityKey:k,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.b(w,Fwx(),0)})},Ymm=function(P,v){var l=[];
if(P.thumbnailStyleData){P=g.N(P.thumbnailStyleData);for(var e=P.next();!e.done;e=P.next()){var h=void 0,z=void 0,m=void 0;l=l.concat(Il((h=e.value)==null?void 0:(z=h.value)==null?void 0:(m=z.collageThumbnail)==null?void 0:m.coverThumbnail))}}v=Il(v);return l.concat(v)},bn3=function(P,v,l){var e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7;
return g.p(function(Pw){e=[];h=new Set;if(l.length)for(z=g.N(l),m=z.next();!m.done;m=z.next())if(Q=m.value,t=void 0,(t=Q.downloads)==null?0:t.length)for(y=g.N(Q.downloads),C=y.next();!C.done;C=y.next())f=C.value,f.videoItem&&(k=g.Ct(f.videoItem).entityId,h.add(k));if(P.videos){w=g.N(P.videos);for(I=w.next();!I.done;I=w.next())J=I.value,K=JSON.parse(g.Ct(J).entityId),K.videoId&&!h.has(K.videoId)&&e.push(K.videoId);q=g.N(v);for(A=q.next();!A.done;A=q.next())if(x=A.value,x.key!==P.key&&(S=x.videos))for(B=
g.N(S),E=B.next();!E.done;E=B.next())r=E.value,hq=JSON.parse(g.Ct(r).entityId),hq.videoId&&(R7=e.indexOf(hq.videoId),R7!==-1&&e.splice(R7,1))}return Pw.return(e)})},AvQ=function(P,v){var l,e,h,z,m,Q,t,y;
return g.p(function(C){l=Il(P.avatar);e=g.N(v);for(h=e.next();!h.done;h=e.next())if(z=h.value,z.id!==P.id)for(m=g.N(Il(z.avatar)),Q=m.next();!Q.done;Q=m.next())t=Q.value,y=l.indexOf(t),y!==-1&&l.splice(y,1);return C.return(l)})},Smy=function(P){var v;
return g.p(function(l){v=g.a(P.frameworkUpdates,cc);return P.frameworkUpdates&&v?g.b(l,aDx(v),0):l.return()})},Xkv=function(P){var v;
if((v=P.onResponseReceivedActions)!=null&&v.length){var l;P=(l=g.a(g.a(P.onResponseReceivedActions[0],GUy),g.dG1))==null?void 0:l.actions;if(P!=null&&P.length)return P}},B13=function(P){var v,l,e;
return g.p(function(h){if(h.W==1)return P?g.b(h,V6(P,g.BV,"mainDownloadsListEntity"),2):h.return([]);v=h.K;return((l=v)==null?0:(e=l.downloads)==null?0:e.length)?h.return(v.downloads.map(function(z){var m;return(m=z.videoItem)!=null?m:""})):h.return([])})},U_Y=function(P,v){var l;
return g.p(function(e){return e.W==1?g.b(e,inb(P,v),2):(l=e.K)?g.b(e,Mv(P,{mode:"readwrite",V7:!0},function(h){var z=[OQ(h,l.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];l.mainDownloadsListEntity&&z.push(OQ(h,l.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.x6.all(z)}),0):e.ac(0)})},inb=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x;
return g.p(function(S){if(S.W==1)return l=g.ft("main_downloads_library_id","mainDownloadsLibraryEntity"),e=g.ft("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.b(S,Mv(P,{mode:"readonly",V7:!0},function(B){return g.x6.all([HD(B,l,"mainDownloadsLibraryEntity"),HD(B,e,"mainDownloadsListEntity")])}),2);
h=S.K;z=g.N(h);m=z.next().value;Q=z.next().value;t=m;y=Q;t||(t={id:l});C=g.N(v);for(f=C.next();!f.done;f=C.next())if(k=f.value,k===g.BV){if(t.smartDownloadsList)return S.return();t.smartDownloadsList=k}else if(w=g.Ct(k).entityType,I={},w==="mainPlaylistEntity"?I.playlistItem=k:w==="mainVideoEntity"&&(I.videoItem=k),!g.pU(I)){J=void 0;if((J=y)==null?0:J.downloads){K=!1;q=g.N(y.downloads);for(A=q.next();!A.done;A=q.next())if(x=A.value,x.playlistItem===k||x.videoItem===k){K=!0;break}K||y.downloads.push(I)}else y=
{id:e,downloads:[I]};t.downloadsList=e}return S.return({mainDownloadsLibraryEntity:t,mainDownloadsListEntity:y})})},ZnG=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K;
return g.p(function(q){if(q.W==1)return l=g.ft("main_downloads_library_id","mainDownloadsLibraryEntity"),e=g.ft("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.b(q,Mv(P,{mode:"readonly",V7:!0},function(A){return g.x6.all([HD(A,l,"mainDownloadsLibraryEntity"),HD(A,e,"mainDownloadsListEntity"),HD(A,g.BV,"mainDownloadsListEntity")])}),2);
h=q.K;z=g.N(h);m=z.next().value;Q=z.next().value;t=z.next().value;y=m;C=Q;f=t;if(!y)return q.ac(0);if(v===g.BV&&((k=f)==null?0:k.downloads))f.downloads=[];else if((w=C)==null?0:w.downloads)for(I=g.Ct(v).entityType,J=0;J<C.downloads.length;J++)if(K=C.downloads[J],I==="mainVideoEntity"&&K.videoItem===v){C.downloads.splice(J,1);break}else if(I==="mainPlaylistEntity"&&K.playlistItem===v){C.downloads.splice(J,1);break}return g.b(q,Mv(P,{mode:"readwrite",V7:!0},function(A){var x=[OQ(A,y,"mainDownloadsLibraryEntity")];
C&&x.push(OQ(A,C,"mainDownloadsListEntity"));f&&x.push(OQ(A,f,"mainDownloadsListEntity"));return g.x6.all(x)}),0)})},qq=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k;
return g.p(function(w){if(w.W==1)return l=g.ft(v,"transfer"),e=g.ft(v,"videoDownloadContextEntity"),g.b(w,Mv(P,{mode:"readonly",V7:!0},function(I){return g.x6.all([HD(I,l,"transfer"),HD(I,e,"videoDownloadContextEntity")])}),2);
h=w.K;z=g.N(h);m=z.next().value;Q=z.next().value;t=m;y=Q;k={videoId:v,cotn:(C=t)==null?void 0:C.cotn,offlineModeType:(f=y)==null?void 0:f.offlineModeType};return w.return(k)})},FJ=function(P,v,l,e,h){var z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq;
return g.p(function(R7){switch(R7.W){case 1:return z=g.ft(P,"musicTrack"),m=g.ft(P,"transfer"),g.b(R7,Mv(v,{mode:"readonly",V7:!0},function(Pw){return g.x6.all([HD(Pw,z,"musicTrack"),HD(Pw,m,"transfer"),EQ(Pw,"musicTrack"),EQ(Pw,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Q=R7.K;t=g.N(Q);y=t.next().value;C=t.next().value;f=t.next().value;k=t.next().value;w=y;I=C;J=f;K=k;if(!w){R7.ac(3);break}return g.b(R7,jFy(w,J),4);case 4:return q=R7.K,g.b(R7,J1(q),3);case 3:A=[];x=g.N(K);for(S=x.next();!S.done;S=x.next())B=S.value,E=g.Ct(B.key).entityId,r=nA(B),hq=g.Ct(r.action.entityKey).entityId,E!==P&&hq!==P||wv(l,B.actionProto)||A.push(B.key);return g.b(R7,Mv(v,{mode:"readwrite",V7:!0},function(Pw){var H=A.map(function(T){return ox(Pw,T)});
H.push(ox(Pw,z,{Ys:!0}));return g.x6.all(H)}),6);
case 6:$p(I),h&&QZ(h),ma(e,{entityKey:z,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.nx(R7)}})},A1=function(P,v,l,e,h){var z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y;
return g.p(function(L){switch(L.W){case 1:return z=g.ft(P,v),m=g.ft("music_downloads_library_id","musicDownloadsLibraryEntity"),g.b(L,Mv(l,{mode:"readonly",V7:!0},function(X){return g.x6.all([HD(X,z,v),HD(X,m,"musicDownloadsLibraryEntity"),EQ(X,v),EQ(X,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Q=L.K;t=g.N(Q);y=t.next().value;C=t.next().value;f=t.next().value;k=t.next().value;w=y;I=C;J=f;K=k;if(!w){L.ac(3);break}return g.b(L,jFy(w,J),4);case 4:return q=L.K,g.b(L,J1(q),3);case 3:A=[];x=new Map;if(!w){L.ac(6);break}return g.b(L,aOy(w,J,I),7);case 7:A=L.K;S=g.N(A);for(B=S.next();!B.done;B=S.next())E=B.value,r=g.Ct(E).entityId,x.set(r,{videoId:r,playlistId:P,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.b(L,d2(l,"transfer"),8);case 8:for(hq=L.K,R7=g.N(hq),
Pw=R7.next();!Pw.done;Pw=R7.next())H=Pw.value,T=g.Ct(H.key).entityId,(n=x.get(T))&&H&&(n.cotn=H.cotn);case 6:W=[];du=g.N(K);for(K1=du.next();!K1.done;K1=du.next())f1=K1.value,Aq=g.Ct(f1.key).entityId,MP=nA(f1),Aq!==P&&MP.rootActionId!==P||wv(e,f1.actionProto)||W.push(f1.key);lY=g.ft(P,v);return g.b(L,Mv(l,{mode:"readwrite",V7:!0},function(X){var lD=W.map(function(zW){return ox(X,zW)});
lD.push(ox(X,lY,{Ys:!0}));return g.x6.all(lD)}),9);
case 9:if(!w){L.ac(0);break}A.reverse();if(!A.length){L.ac(0);break}$3=g.N(A);c=$3.next();case 12:if(c.done){L.ac(0);break}F=c.value;Y=g.Ct(F).entityId;if(!Y){L.ac(13);break}return g.b(L,FJ(Y,l,e,h,x.get(Y)),13);case 13:c=$3.next(),L.ac(12)}})},Yp=function(P,v,l){var e,h,z,m,Q,t,y;
return g.p(function(C){if(C.W==1)return g.b(C,Mv(P,{mode:"readwrite",V7:!0},function(f){var k=EQ(f,"transfer"),w=EQ(f,"offlineOrchestrationActionWrapperEntity");return g.x6.all([k,w]).then(function(I){I=g.N(I);var J=I.next().value;var K=I.next().value;I=Hno.map(function(S){return YJv(f,S)});
K=g.N(K);for(var q=K.next();!q.done;q=K.next()){q=q.value;var A=g.Ct(q.actionProto.entityKey).entityType==="musicTrack",x=q.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";wv(v,q.actionProto)||A&&(!A||x)||I.push(ox(f,q.key,{Ys:!0}))}return g.x6.all(I).then(function(){return J})})}),2);
e=C.K;h=g.N(e);for(z=h.next();!z.done;z=h.next())m=z.value,$p(m),Q=g.Ct(m.key).entityId,t={videoId:Q,offlineDeleteReason:void 0,cotn:m.cotn},QZ(t),y=g.ft(Q,"musicTrack"),ma(l,{entityKey:y,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.b(C,Fwx(),0)})},E1Q=function(P){for(var v,l=g.N(P.additionalMetadatas),e=l.next();!e.done;e=l.next())e=e.value,e.offlineMusicVideoData&&(v=e.offlineMusicVideoData);
var h,z,m,Q,t;return{id:g.ft(P.videoId,"musicTrack"),videoId:P.videoId,title:P.title,thumbnailDetails:P.thumbnail,lengthMs:String(Number(P.lengthSeconds)*1E3),albumTitle:(h=v)==null?void 0:h.releaseTitle,musicVideoType:(z=v)==null?void 0:z.musicVideoType,contentRating:{explicitType:(m=v)==null?void 0:m.explicitType},artistNames:((Q=v)==null?void 0:Q.byline)||((t=v)==null?void 0:t.channelName),downloadMetadata:g.ft(P.videoId,"musicTrackDownloadMetadataEntity")}},aOy=function(P,v,l){var e,h,z,m,Q,t,
y,C,f,k,w,I,J,K,q,A,x,S;
return g.p(function(B){e=[];h=new Set;if((z=l)==null?0:(m=z.downloadedTracks)==null?0:m.length)for(Q=g.N(l.downloadedTracks),t=Q.next();!t.done;t=Q.next())y=t.value,h.add(y);if(P.tracks){C=g.N(P.tracks);for(f=C.next();!f.done;f=C.next())k=f.value,h.has(k)||e.push(k);w=g.N(v);for(I=w.next();!I.done;I=w.next())if(J=I.value,J.id!==P.id&&(K=J.tracks))for(q=g.N(K),A=q.next();!A.done;A=q.next())x=A.value,S=e.indexOf(x),S!==-1&&e.splice(S,1)}return B.return(e)})},jFy=function(P,v){var l,e,h,z,m,Q,t,y;
return g.p(function(C){l=Il(P.thumbnailDetails);e=g.N(v);for(h=e.next();!h.done;h=e.next())if(z=h.value,z.id!==P.id)for(m=g.N(Il(z.thumbnailDetails)),Q=m.next();!Q.done;Q=m.next())t=Q.value,y=l.indexOf(t),y!==-1&&l.splice(y,1);return C.return(l)})},Wwy=function(P,v){var l,e,h,z,m,Q,t,y,C;
return g.p(function(f){if(f.W==1)return l=g.ft("music_downloads_library_id","musicDownloadsLibraryEntity"),g.b(f,V6(P,l,"musicDownloadsLibraryEntity"),2);(e=f.K)||(e={id:l});h=g.Ct(v).entityType;h==="musicTrack"?(z=e.downloadedTracks)!=null&&z.includes(v)||(e.downloadedTracks=((m=e.downloadedTracks)!=null?m:[]).concat(v)):h==="musicPlaylist"?(Q=e.downloadedPlaylists)!=null&&Q.includes(v)||(e.downloadedPlaylists=((t=e.downloadedPlaylists)!=null?t:[]).concat(v)):h!=="musicAlbumRelease"||(y=e.downloadedAlbumReleases)!=
null&&y.includes(v)||(e.downloadedAlbumReleases=((C=e.downloadedAlbumReleases)!=null?C:[]).concat(v));return g.b(f,Ts(P,e,"musicDownloadsLibraryEntity"),0)})},On1=function(P,v){var l,e,h,z,m,Q,t;
return g.p(function(y){if(y.W==1)return l=g.ft("music_downloads_library_id","musicDownloadsLibraryEntity"),g.b(y,V6(P,l,"musicDownloadsLibraryEntity"),2);e=y.K;if(!e)return y.ac(0);h=g.Ct(v).entityType;h==="musicTrack"?z=e.downloadedTracks:h==="musicPlaylist"&&(z=e.downloadedPlaylists);if((m=z)==null?0:m.length)for(Q=0;Q<z.length;Q++)if(t=z[Q],t===v){z.splice(Q,1);break}return g.b(y,Ts(P,e,"musicDownloadsLibraryEntity"),0)})},o1Q=function(P){var v=P.videos;
P=[];var l=[];if(v){v=g.N(v);for(var e=v.next();!e.done;e=v.next()){var h=e.value.offlineVideoData.videoId;e=g.ft(h,"musicTrack");h=g.ft(h,"musicTrackDownloadMetadataEntity");P.push(e);l.push(h)}}return{q3:P,o1:l}},bw=function(P,v,l){v={track:E1Q(v)};
l&&(v.playlistId=l);if(P=g.a(P.actionMetadata,sFy))v.maximumDownloadQuality=P.maximumDownloadQuality;return{musicTrackEntityActionMetadata:v}},M8b=function(P){var v,l,e,h,z,m,Q,t;
return g.p(function(y){switch(y.W){case 1:return v=g.yn(),l=MKQ(P),e=g.$S(rvd),g.NP(y,2),z={aq:!0},g.b(y,g.d9(v,l,e,void 0,z),4);case 4:h=y.K;g.uD(y,3);break;case 2:m=g.Kx(y);if(m instanceof g.RH)throw Q="GetOffline network manager error: "+m.message,h1(Q,m),Error(Q);h1("GetOffline fetch request error",m);throw Error("GetOffline fetch request error");case 3:t=xp(h);if(!h)throw h1("Network request failed"),Error("Network request failed");if(t!==void 0)pA(t);else if(!h.videos||!h.videos.length)throw h1("No data"),
Error("No data");return y.return(h.videos.map(function(C){return C.offlineVideoData}))}})},T1A=function(P){var v,l,e,h,z,m,Q,t;
return g.p(function(y){switch(y.W){case 1:return v=g.yn(),l=Ts1(P),e=g.$S(rvd),g.NP(y,2),z={aq:!0},g.b(y,g.d9(v,l,e,void 0,z),4);case 4:h=y.K;g.uD(y,3);break;case 2:m=g.Kx(y);if(m instanceof g.RH)throw Q="GetOffline network manager error for playlist: "+m.message,h1(Q,m),Error(Q);h1("GetOffline fetch request error for playlist",m);throw Error("GetOffline fetch request error for playlist");case 3:t=xp(h);if(!h)throw h1("Network request failed for playlist"),Error("Network request failed for playlist");
if(t!==void 0)pA(t,"playlist");else if(!h.playlists||!h.playlists.length)throw h1("No data for playlist"),Error("No data for playlist");return y.return(h.playlists.map(function(C){return C.offlinePlaylistData}))}})},d_y=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1;
return g.p(function(Aq){switch(Aq.W){case 1:return g.b(Aq,Pc(),2);case 2:h=Aq.K;if(!h)return Aq.return([]);z=[];if((m=e)==null?0:m.length){z=e;Aq.ac(3);break}return g.b(Aq,d2(h,"mainPlaylistEntity"),4);case 4:z=Aq.K;case 3:if(!z.length)return Aq.return([]);Q=[];t=Date.now()/1E3;y=g.N(z);C=y.next();case 5:if(C.done)return Q.length?g.b(Aq,V8y(Q),10):Aq.return([]);f=C.value;if(!f.downloadState){k=void 0;Aq.ac(8);break}return g.b(Aq,V6(h,f.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:k=
Aq.K;case 8:w=k;I=void 0;K=(J=(I=f)==null?void 0:I.entityMetadata)&&J.nextAutoRefreshIntervalSeconds?Number(J.nextAutoRefreshIntervalSeconds):NaN;q=Number.isNaN(K)?P:K;x=A=void 0;S=((A=w)==null?0:A.lastSyncedTimestampMillis)?Number((x=w)==null?void 0:x.lastSyncedTimestampMillis)/1E3:0;E=B=void 0;r=((B=w)==null?0:B.addedTimestampMillis)?Number((E=w)==null?void 0:E.addedTimestampMillis)/1E3:0;if(l||!J||S+q<=t){hq=[];R7=void 0;if((R7=f.videos)==null?0:R7.length)for(Pw=g.N(f.videos),H=Pw.next();!H.done;H=
Pw.next())T=H.value,n=JSON.parse(g.Ct(T).entityId),n.videoId&&hq.push(n.videoId);W="0";J&&(du=void 0,W=String(Number((du=J.offlineLastModifiedTimestampSeconds)!=null?du:0).toFixed()));K1={playlistId:f.playlistId,videoIds:hq,offlineLastModifiedTimestamp:W,autoSync:v,offlineDateAddedTimestamp:String(r.toFixed())};Q.push(K1)}C=y.next();Aq.ac(5);break;case 10:return f1=Aq.K,Aq.return(f1)}})},Pxy=function(){var P,v,l,e,h;
return g.p(function(z){if(z.W==1)return g.b(z,Pc(),2);if(z.W!=3)return(P=z.K)?g.b(z,d2(P,"refresh"),3):z.return(!1);v=z.K;if((l=v[0])==null||!l.refreshTime)return z.return(!1);e=Number(v[0].refreshTime);h=Date.now()/1E3;return z.return(isFinite(e)&&h>=e)})},lby=function(P,v){var l,e,h;
return g.p(function(z){switch(z.W){case 1:return g.NP(z,2),g.b(z,vgb(P,v),4);case 4:return e=z.K,g.b(z,Smy(e),5);case 5:l=Xkv(e);g.uD(z,3);break;case 2:h=g.Kx(z),h1("getAndProcessSmartDownloadsResponse request or processing error",h);case 3:return z.return(l)}})},e3o=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1;
return g.p(function(Aq){switch(Aq.W){case 1:return g.b(Aq,Pc(),2);case 2:h=Aq.K;if(!h)return Aq.return([]);z=[];if((m=e)==null?0:m.length){z=e;Aq.ac(3);break}return g.b(Aq,d2(h,"musicPlaylist"),4);case 4:z=Aq.K;case 3:if(!z.length)return Aq.return([]);Q=[];t=Date.now()/1E3;y=g.N(z);C=y.next();case 5:if(C.done)return Q.length?g.b(Aq,V8y(Q),10):Aq.return([]);f=C.value;k=void 0;I=(w=(k=f)==null?void 0:k.entityMetadata)&&w.nextAutoRefreshIntervalSeconds?Number(w.nextAutoRefreshIntervalSeconds):NaN;J=
Number.isNaN(I)?P:I;q=K=0;A="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!f.downloadMetadata){Aq.ac(8);break}return g.b(Aq,V6(h,f.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:x=Aq.K,B=S=void 0,K=Number((B=(S=x)==null?void 0:S.addedTimestampMillis)!=null?B:"0")/1E3,r=E=void 0,q=Number((r=(E=x)==null?void 0:E.lastModifiedTimestampMillis)!=null?r:"0")/1E3,R7=hq=void 0,A=(R7=(hq=x)==null?void 0:hq.syncState)!=null?R7:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:Pw=void 0;if(l||A!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!w||Number((Pw=w.lastSyncedTimestampSeconds)!=null?Pw:0)+J<=t){H=[];T=void 0;if((T=f.tracks)==null?0:T.length)for(n=g.N(f.tracks),W=n.next();!W.done;W=n.next())du=W.value,H.push(g.Ct(du).entityId);K1={playlistId:f.playlistId,videoIds:H,offlineLastModifiedTimestamp:String(q.toFixed()),autoSync:v,offlineDateAddedTimestamp:String(K.toFixed())};Q.push(K1)}C=y.next();Aq.ac(5);break;case 10:return f1=Aq.K,Aq.return(f1)}})},vgb=function(P,v){var l,e,h,z,m,Q,t,y,C,f;
return g.p(function(k){switch(k.W){case 1:return l=g.yn(),g.b(k,Pc(),2);case 2:e=k.K;if(!e){k.ac(3);break}return g.b(k,hio(e),4);case 4:h=k.K;case 3:var w=h;z={context:g.lo(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:P},offlineClientState:w,clientStateRequestData:{preferredFormatType:v}}}};m=g.$S(h3Q);g.NP(k,5);t={aq:!0};return g.b(k,g.d9(l,z,m,void 0,t),7);case 7:Q=k.K;g.uD(k,6);break;case 5:y=g.Kx(k);if(y instanceof g.RH)throw C=
"DPS network manager error for smart downloads: "+y.message,h1(C,y),Error(C);h1("DPS fetch request error for smart downloads",y);throw Error("DPS fetch request error for smart downloads");case 6:f=xp(Q);if(Q)f!==void 0&&pA(f,"smart downloads");else throw h1("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return k.return(Q)}})},mRo=function(P,v){var l,e,h,z,m,Q,t,y;
return g.p(function(C){switch(C.W){case 1:return l=g.yn(),e={context:g.lo(),videoPlaybackPositionEntities:P,lastSyncTimestampUsec:v},h=g.$S(z31),g.NP(C,2),m={aq:!0},g.b(C,g.d9(l,e,h,void 0,m),4);case 4:z=C.K;g.uD(C,3);break;case 2:Q=g.Kx(C);if(Q instanceof g.RH)throw t="VPPS network manager error: "+Q.message,h1(t,Q),Error(t);h1("VPPS fetch request error",Q);throw Error("VPPS fetch request error");case 3:y=xp(z);if(z)y!==void 0&&pA(y,"position sync");else throw h1("Network request failed for position sync"),
Error("Network request failed for position sync");return C.return(z)}})},QAx=function(P,v,l){var e,h,z,m,Q,t,y,C;
return g.p(function(f){switch(f.W){case 1:e=g.yn();var k=l.refreshData,w=l.isEnqueuedForExpiredStreamUrlRefetch,I=l.Zy,J=l.offlineSourceData,K=l.mediaCapabilities,q={entityKey:P};k&&(q.refreshData=k);w&&(q.isExpiredStreamUrlRefetch=w);I&&(q.downloadParameters=I);J&&(q.offlineSourceData=J);k={context:g.R0(v),signatureTimestamp:20123,videos:[q]};K&&(k.mediaCapabilities=K);h=k;z=g.$S(R3v);g.NP(f,2);Q={aq:!0};return g.b(f,g.d9(e,h,z,void 0,Q),4);case 4:m=f.K;g.uD(f,3);break;case 2:t=g.Kx(f);if(t instanceof
g.RH)throw y="GetPDE network manager error: "+t.message,h1(y,t),Error(y);h1("GetPDE fetch request error",t);throw Error("GetPDE fetch request error");case 3:C=xp(m);if(m)C!==void 0&&pA(C,"PDE");else throw h1("Network request failed for PDE"),Error("Network request failed for PDE");return f.return(m)}})},xp=function(P){var v;
return(v=P.errorMetadata)==null?void 0:v.status},pA=function(P,v){v=v?" for "+v:"";
if(P===0)throw P="Empty response body"+v,h1(P),Error(P);P="Response with error"+v;h1(P);throw Error(P);},V8y=function(P){var v,l,e,h,z,m,Q,t;
return g.p(function(y){switch(y.W){case 1:return v=g.yn(),l=VKo(P),e=g.$S(tZy),g.NP(y,2),z={aq:!0},g.b(y,g.d9(v,l,e,void 0,z),4);case 4:h=y.K;g.uD(y,3);break;case 2:m=g.Kx(y);if(m instanceof g.RH)throw Q="offlinePlaylistSyncCheck network manager error: "+m.message,h1(Q,m),Error(Q);h1("offlinePlaylistSyncCheck fetch request error",m);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:t=xp(h);if(!h)throw h1("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(t!==void 0)pA(t,"playlist sync");else if(!h.offlinePlaylistSyncCheckDatas||!h.offlinePlaylistSyncCheckDatas.length)throw h1("No data for playlist sync"),Error("No data for playlist sync");return y.return(h.offlinePlaylistSyncCheckDatas.map(function(C){return C.offlinePlaylistSyncCheckData}))}})},LA=function(P){this.W=P},yJy=function(P,v){var l,e,h,z,m,Q;
return g.p(function(t){switch(t.W){case 1:l=new Map,e=g.N(v),h=e.next();case 2:if(h.done){t.ac(4);break}z=h.value;m=l;Q=m.set;return g.b(t,P.K(z),5);case 5:Q.call(m,z,t.K);h=e.next();t.ac(2);break;case 4:return t.return(l)}})},So=function(P,v,l,e,h,z){v=g.ft(v,l);
e=Object.assign({},z,{priority:e,retryScheduleIntervalsInSeconds:h});return{actionType:P,entityKey:v,actionMetadata:e}},GC=function(P,v,l,e,h,z){this.status=P;
this.W=v;this.Y=l;this.K=e;this.G=h;this.downloadState=z},Cxy=function(P,v,l){this.W=P;
this.O$=v;this.G=l},k2b=function(P,v){var l,e,h,z,m,Q,t,y,C;
return g.p(function(f){switch(f.W){case 1:return l=v.entityKey,h=(e=g.a(v.actionMetadata,XJ))==null?void 0:e.isEnqueuedForExpiredStreamUrlRefetch,g.NP(f,2),z=void 0,g.b(f,fbb(P,v),4);case 4:z=f.K;g.NP(f,5);var k=(k=g.a(v.actionMetadata,XJ))?{maximumDownloadQuality:k.maximumDownloadQuality}:void 0;return g.b(f,QAx(l,P.O$,{isEnqueuedForExpiredStreamUrlRefetch:h,Zy:k,offlineSourceData:z}),7);case 7:m=f.K;g.uD(f,6,2);break;case 5:return g.Kx(f,2),Q=yZ(v)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",h1("PDE handleAdd error"),f.return(Bc(v,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",Q,"DOWNLOAD_STATE_FAILED"));case 6:return g.b(f,ggy(P,m,v),8);case 8:return f.return(Bc(v,!0,m.orchestrationActions));case 2:return t=g.Kx(f),y="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",C="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",t instanceof g.KR&&t.type==="QUOTA_EXCEEDED"&&(y="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
C="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),h1("PDE handleAdd error"),f.return(Bc(v,!1,void 0,y,C,"DOWNLOAD_STATE_FAILED"))}})},Ib1=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7;
return g.p(function(Pw){switch(Pw.W){case 1:return l=v.entityKey,e=g.Ct(l).entityId,g.b(Pw,Mv(P.W,{mode:"readonly",V7:!0},function(H){var T=HD(H,l,"playbackData"),n=HD(H,g.ft(e,"offlineVideoPolicy"),"offlineVideoPolicy");H=HD(H,g.ft(e,"transfer"),"transfer");return g.x6.all([T,n,H])}),2);
case 2:h=Pw.K;z=g.N(h);m=z.next().value;Q=z.next().value;t=z.next().value;y=m;C=Q;f=t;if(!y||!C)return Pw.return(Bc(v,!0));k=[];J=((I=y)==null?0:I.playerResponseJson)?JSON.parse(y.playerResponseJson):null;if(!(f&&J&&P.O$.V("html5_refresh_deprecated_downloads"))){Pw.ac(3);break}w=wLx(P,J,f);return g.b(Pw,$Rj(P,f),4);case 4:k=Pw.K;case 3:K={lastPlayerResponseTimestampSeconds:y.playerResponseTimestamp,offlineToken:C.offlineToken,formatIds:k};q={};if((A=f)==null?0:A.maximumDownloadQuality)q.maximumDownloadQuality=
f.maximumDownloadQuality;g.NP(Pw,5);x=void 0;return g.b(Pw,fbb(P,v),7);case 7:return x=Pw.K,g.NP(Pw,8),g.b(Pw,QAx(l,P.O$,{refreshData:K,Zy:q,offlineSourceData:x,mediaCapabilities:w}),10);case 10:S=Pw.K;g.uD(Pw,9,5);break;case 8:return g.Kx(Pw,5),B=yZ(v)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",h1("PDE handleRefresh error"),Pw.return(Bc(v,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",B,
"DOWNLOAD_STATE_FAILED"));case 9:return g.b(Pw,ggy(P,S,v),11);case 11:return Pw.return(Bc(v,!0,S.orchestrationActions));case 5:return E=g.Kx(Pw),r="PDE handleRefresh error",E instanceof Error&&(r="PDE handleRefresh error: "+E.message),hq="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",R7="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",E instanceof g.KR&&E.type==="QUOTA_EXCEEDED"&&(hq="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",R7="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
h1(r),Pw.return(Bc(v,!1,void 0,hq,R7,"DOWNLOAD_STATE_FAILED"))}})},fbb=function(P,v){var l,e,h,z;
return g.p(function(m){if(m.W==1)return l=g.Ct(v.entityKey).entityId,e=g.ft(l,"videoDownloadContextEntity"),g.b(m,V6(P.W,e,"videoDownloadContextEntity"),2);h=m.K;return(z=h)!=null&&z.offlineModeType?m.return({offlineModeType:h.offlineModeType}):m.return(void 0)})},ggy=function(P,v,l){var e,h,z,m,Q;
return g.p(function(t){if(t.W==1){if(!v.frameworkUpdates||!g.a(v.frameworkUpdates,cc))return t.return();if(!(g.a(v.frameworkUpdates,cc).mutations&&g.a(v.frameworkUpdates,cc).mutations.length>0&&g.a(v.frameworkUpdates,cc).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return t.ac(2);e=g.Ct(g.a(v.frameworkUpdates,cc).mutations[0].entityKey).entityId;return g.b(t,qq(P.W,e),3)}if(t.W!=2){h=t.K;z=g.a(l.actionMetadata,XJ);if(Q=(m=z)==null?void 0:m.playlistId)h.playlistId=Q;h.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.Po(P.O$)?g.b(t,KA(e,P.W,l,P.G,h),2):g.H$(P.O$)?g.b(t,FJ(e,P.W,l,P.G),2):t.ac(2)}return g.b(t,aDx(g.a(v.frameworkUpdates,cc)),0)})},Bc=function(P,v,l,e,h,z){return new GC(v?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",yZ(P),l,e,h,z)},wLx=function(P,v,l){v=cvd(P.O$,l.cotn,v);
l=g.Cj(v);return g.AR6(v,l,P.O$)},$Rj=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k;
return g.p(function(w){if(w.W==1)return l=[],g.b(w,Mv(P.W,{mode:"readonly",V7:!0},function(I){var J=[],K=v.offlineVideoStreams;if(K){K=g.N(K);for(var q=K.next();!q.done;q=K.next())J.push(HD(I,q.value,"offlineVideoStreams"))}return g.x6.all(J)}),2);
if(e=w.K)for(h=g.N(e),z=h.next();!z.done;z=h.next())if(m=z.value,Q=void 0,(Q=m)==null?0:Q.streamsProgress)for(t=m.streamsProgress,y=0;y<t.length;y++)C=t[y],f=JSON.parse(C.formatStreamBytes),k={itag:f.itag,lmt:f.lastModified,xtags:f.xtags},l.push(k);return w.return(l)})},DRA=function(P,v){this.W=P;
this.O$=v},ngd=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w;
return g.p(function(I){switch(I.W){case 1:return l=yZ(v),g.b(I,d2(P.W,"videoPlaybackPositionEntity"),2);case 2:e=I.K;if(e.length===0)return I.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));g.NP(I,3);return g.b(I,Za.getInstance(),5);case 5:h=I.K;if(!h)throw Error("prefStorage is undefined");return g.b(I,h.get("psi"),6);case 6:return z=I.K,t=(Q=(m=z)==null?void 0:m.b6)!=null?Q:"0",g.b(I,mRo(e,t),7);case 7:return y=I.K,C={isPaused:y.watchHistoryPaused,b6:y.syncTimestampUsec},g.b(I,h.set("psi",
C),8);case 8:if(C.isPaused){I.ac(9);break}f=g.a(y.frameworkUpdates,cc);if(!y.frameworkUpdates||!f){I.ac(9);break}return g.b(I,aDx(f),9);case 9:g.uD(I,4);break;case 3:return k=g.Kx(I),w="PPE handleRefresh error: "+(k instanceof Error?k.message:"unknown error"),h1(w),I.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return I.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},JJy=function(P,v){var l,e,h,z,m,Q,t,y;
return g.p(function(C){switch(C.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey).entityId,g.NP(C,2),g.b(C,Za.getInstance(),4);case 4:h=C.K;if(!h)throw Error("prefStorage is undefined");return g.b(C,h.get("psi"),5);case 5:z=C.K;m=g.a(v.actionMetadata,NP3);if(((Q=z)==null?void 0:Q.isPaused)!==!1||(t=m)==null||!t.lastPlaybackPositionSeconds){C.ac(6);break}y={key:g.ft(e,"videoPlaybackPositionEntity"),videoId:e,lastPlaybackPositionSeconds:m.lastPlaybackPositionSeconds};return g.b(C,Ts(P.W,y,"videoPlaybackPositionEntity"),
6);case 6:g.uD(C,3);break;case 2:return g.Kx(C),C.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l))}})},uax=function(P,v){var l,e,h;
return g.p(function(z){switch(z.W){case 1:l=yZ(v);g.NP(z,2);e=g.Ct(v.entityKey).entityId;if(e==="!*$_ALL_ENTITIES_!*$")return g.b(z,Bs1(P.W),5);h=g.ft(e,"videoPlaybackPositionEntity");return g.b(z,XF1(P.W,h),5);case 5:g.uD(z,3);break;case 2:return g.Kx(z),z.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return z.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},KUm=function(P,v){this.api=P;
this.W=v;this.logger=new g.Rf("woffle");this.K=!1;this.Kh={F9:this.F9};this.logger.debug("Initialized OfflineMediaManager")},cJA=function(P){return g.p(function(v){return v.return(rx3(P))})},qzd=function(P){var v;
return g.p(function(l){if(l.W==1)return g.b(l,g.PJ6(P),2);v=l.K;return l.return(v.filter(function(e){return!!e.url}).map(function(e){return e.url}))})},iw=function(P,v){var l=g.L_(v);
if(l===1||l===0)return Promise.resolve();(l=FUQ(P,v))&&l.stopVideo();P.G=0;return cJA(v)},Up=function(P,v,l,e){l=l===void 0?!1:l;
e=e===void 0?!0:e;var h=typeof v==="string"?v:v.videoDetails.videoId;g.L_(h)===2&&((v=FUQ(P,h))?v.stopVideo():P.logger.info(function(){return"Corresponding player for "+h+" not found. Pausing anyway"}),g.S0(h,2),P.G=2,l?AJj(P.W):e&&YzG(P.W))},FUQ=function(P,v){var l;
return((l=P.player)==null?void 0:l.getVideoData().videoId)===v?P.player:null},bbA=function(P,v,l){v.getPlayerResponse();
g.S0(v.videoId,2);P.G=2;P.K=!1;var e;(e=P.player)==null||e.dispose();P.player=P.api.VX(v);v={};P.player.UW((v.localmediachange=P.Q$,v.signatureexpired=P.qS,v.statechange=P.KD3,v),P);var h=P.F9(l);P.player.wd(g.Ra(h,h,!0,"m"),!1);P.logger.debug(function(){return"Starting headless playback with quality: "+h});
P.player.eA(!1)},xRy=function(P,v){this.W=P;
this.O$=v},LUo=function(P,v){var l,e;
return g.p(function(h){switch(h.W){case 1:return l=yZ(v),g.b(h,V6(P.W,v.entityKey,"transfer"),2);case 2:if(e=h.K)return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));g.NP(h,3);return g.b(h,pLQ(P,v),5);case 5:g.uD(h,4);break;case 3:return g.Kx(h),h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},Szy=function(P,v){var l,e;
return g.p(function(h){switch(h.W){case 1:return l=yZ(v),g.b(h,V6(P.W,v.entityKey,"transfer"),2);case 2:e=h.K;if(!e||e.transferState!=="TRANSFER_STATE_COMPLETE")return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));g.NP(h,3);return g.b(h,pLQ(P,v,!0),5);case 5:g.uD(h,4);break;case 3:return g.Kx(h),h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l))}})},G2y=function(P,v){var l,e,h,z,m,Q,t,y,C,f;
return g.p(function(k){switch(k.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey).entityId,g.b(k,Mv(P.W,{mode:"readonly",V7:!0},function(w){var I=HD(w,v.entityKey,"transfer");w=HD(w,g.ft(e,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.x6.all([I,w])}),2);
case 2:h=k.K;z=g.N(h);m=z.next().value;Q=z.next().value;t=m;y=Q;if(!t||t.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return k.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));g.NP(k,3);t.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.b(k,Ts(P.W,t,"transfer"),5);case 5:C=g.Ct(t.key).entityId;t1({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},{videoId:C,qj:t,offlineModeType:(f=y)==null?void 0:f.offlineModeType});g.uD(k,
4);break;case 3:return g.Kx(k),k.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return k.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l))}})},pLQ=function(P,v,l){l=l===void 0?!1:l;
var e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q;return g.p(function(A){switch(A.W){case 1:return e=g.a(v.actionMetadata,XLy),h=g.Ct(v.entityKey).entityId,z=g.ft(h,"downloadStatusEntity"),g.b(A,Mv(P.W,{mode:"readonly",V7:!0},function(x){var S=HD(x,z,"downloadStatusEntity");x=HD(x,g.ft(h,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.x6.all([S,x])}),2);
case 2:return m=A.K,Q=g.N(m),t=Q.next().value,y=Q.next().value,C=t,f=y,k="TRANSFER_STATE_TRANSFER_IN_QUEUE",((w=C)==null?void 0:w.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(k="TRANSFER_STATE_PAUSED_BY_USER"),K={key:v.entityKey,transferState:k,cotn:g.YR(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(I=e)==null?void 0:I.maximumDownloadQuality,preferredAudioTrack:(J=e)==null?void 0:J.preferredAudioTrack,transferRetryCount:0,isRefresh:l,hasLoggedFirstStarted:!1},g.b(A,Mv(P.W,
{mode:"readwrite",V7:!0},function(x){var S=[];l&&S.push(ox(x,g.ft(h,"offlineVideoStreams")));S.push(OQ(x,K,"transfer"));return g.x6.all(S)}),3);
case 3:if(!l){A.ac(4);break}return g.b(A,cJA(h),4);case 4:t1({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",statusType:"ADDED_TO_QUEUE"},{videoId:h,qj:K,offlineModeType:(q=f)==null?void 0:q.offlineModeType}),g.nx(A)}})},ibx=function(P,v,l,e){if(!P.action.entityKey)throw Error("entityKey is missing.");
var h=g.Ct(P.action.entityKey);h={entityType:h.nC,entityId:h.entityId,offlineOrchestrationActionType:P.action.actionType,orchestrationAction:{orchestrationActionId:P.actionId}};v&&(h.offlineOrchestrationActionResult=v.status,h.isRetryable=l?!1:v.W,v.G&&(h.offlineOrchestrationFailureReason=BPy(v.G,h.isRetryable)));var z,m;if((z=P.action.actionMetadata)==null?0:(m=z.offlineLoggingData)==null?0:m.offlineModeType)h.offlineModeType=P.action.actionMetadata.offlineLoggingData.offlineModeType;e&&(h.additionalOrchestrationActions=
e.map(function(Q){return{orchestrationActionId:Q.actionId}}));
return h},BPy=function(P,v){return P!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||v?P==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&v?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":P:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},URA=function(P,v){var l={offlineOrchestrationContext:ibx(P)};
v=lOy(v,l);ei1(v1y(),v,P.rootActionId)},Zbd=function(P,v,l,e){e=e===void 0?[]:e;
v={offlineOrchestrationContext:ibx(P,v,l,e)};v=lOy(3,v);ei1(v1y(),v,P.rootActionId)},jAy=function(){this.actions=[]},aby=function(P,v){v=g.N(v);
for(var l=v.next();!l.done;l=v.next())l=l.value,URA(l,1),P.actions.push(l);P.actions.sort(P.W)},Hby=function(P,v){if(v)for(var l=0;l<P.actions.length;l++)if(v==="!*$_ALL_ENTITIES_!*$"&&P.actions[l].actionId!==v||v!=="!*$_ALL_ENTITIES_!*$"&&P.actions[l].rootActionId===v&&P.actions[l].actionId!==v)P.actions.splice(l,1),l--},Egv=function(P,v){P=g.N(P.actions);
for(var l=P.next();!l.done;l=P.next())if(l.value.actionId===v)return!0;return!1},ZK=function(P,v,l,e,h){g.U.call(this);
var z=this;this.K=P;this.J5=v;this.Wg=l;this.j=e;this.O$=h;this.W=new jAy;this.T=new g.PY;this.G=new g.mr(function(){z.retry()});
this.S=NaN;this.Z=!1;this.Kh={beM:function(){return z.W},
vH:function(){return z.T},
APf:function(){return z.G},
retry:function(){return z.retry()}};
g.Z(this,this.G);this.X=this.K.observe(this.QW.bind(this))},og3=function(P,v,l,e,h){var z;
return g.p(function(m){if(m.W==1)return z=new ZK(P,v,l,e,h),g.b(m,WUA(z),2);Oby(z);return m.return(z)})},Oby=function(P){var v=P.W.actions[0];
return P.Y?((v==null?void 0:v.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&P.Y[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(P.Z=!0),Promise.resolve()):sAy(P)},sAy=function(P){var v,l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q;
return g.p(function(A){switch(A.W){case 1:if(P.Y)throw Error("Already processing an action");if(P.s$())return A.return();v=P.W.actions.shift();$_y(P.Wg,!v);if(v===void 0)return A.return();v.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&v.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&Hby(P.W,v.actionId);l="";v.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&v.rootActionId===v.actionId&&(l=v.actionId);e=[v];P.Y=e;if(h=P.J5[v.entityType]){A.ac(2);break}P.Y=
void 0;return g.b(A,sAy(P),3);case 3:return A.return();case 2:z=g.N(e);for(m=z.next();!m.done;m=z.next())Q=m.value,URA(Q,2);g.NP(A,4,5);return g.b(A,yJy(h,e.map(function(x){return x.action})),7);
case 7:t=A.K,y=g.N(e),C=y.next();case 8:if(C.done){A.ac(10);break}f=C.value;k=t.get(f.action);return g.b(A,rJv(P,f,k),9);case 9:C=y.next();A.ac(8);break;case 10:Hby(P.W,l);case 5:g.cw(A);P.Y=void 0;g.qP(A,6);break;case 4:return w=g.Kx(A),h1("Orchestration error",w),g.NP(A,12),g.b(A,MZy(P,e),14);case 14:g.uD(A,5);break;case 12:I=g.Kx(A);h1("Orchestration retry error",I);J=g.N(e);for(K=J.next();!K.done;K=J.next())q=K.value,q.retryScheduleIndex<3&&aby(P.W,[q]);A.ac(5);break;case 6:return g.b(A,sAy(P),
0)}})},rJv=function(P,v,l){var e,h,z,m,Q,t,y,C,f,k,w,I;
return g.p(function(J){switch(J.W){case 1:e=v.retryScheduleIndex+2===3;if(l.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){J.ac(2);break}if(l.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){J.ac(0);break}Zbd(v,l,e);if(l.W&&v.retryScheduleIndex+1<3)return g.b(J,MZy(P,[v]),0);z=((h=l)==null?0:h.K)?l.K:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";m={entityKey:v.action.entityKey,failureReason:z};Q=void 0;g.Po(P.O$)?Q="mainVideoDownloadStateEntity":g.H$(P.O$)&&(Q="musicTrackDownloadMetadataEntity");
if(!Q||!l.downloadState){J.ac(7);break}t=g.Ct(v.action.entityKey).entityId;return g.b(J,kp(t,Q,P.K,l.downloadState),7);case 7:ma(P.j,m);if(l.downloadState==="DOWNLOAD_STATE_FAILED"&&P.O$.V("html5_auto_retry_failed_pde_actions")){J.ac(0);break}h1("Orchestration result is not retryable, deleting action");return g.b(J,XF1(P.K,Nq(v).key),0);case 2:y=void 0;try{y=(C=l.Y)==null?void 0:C.map(function(K){return P.createAction(K,v)})}catch(K){return Zbd(v,l,e),f={entityKey:v.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},ma(P.j,f),h1("Orchestration subactions creation error",K),J.return()}Zbd(v,l,e,y);if(!y){J.ac(12);break}k=y.map(function(K){return Nq(K)});
w=0;case 13:if(!(w<y.length)||P.Z){J.ac(15);break}return g.b(J,Mv(P.K,{mode:"readwrite",V7:!0},function(K){var q=[];q.push(qJ3(K,k.slice(w,w+10),"offlineOrchestrationActionWrapperEntity"));return g.x6.all(q)}),16);
case 16:w+=10;J.ac(13);break;case 15:if(P.Z)return P.Z=!1,J.return();case 12:return I=Nq(v),g.b(J,XF1(P.K,I.key),17);case 17:URA(v,4),g.nx(J)}})},Pny=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w;
return g.p(function(I){l=[];e=Infinity;h=4E3;z=g.N(v);for(m=z.next();!m.done;m=z.next())Q=m.value,t=Number(Q.enqueueTimeSec),y=TPx(t),C=Q.retryScheduleIndex,f=C!=null&&C>0,y>0&&f?(e=Math.min(e,t),h=Math.min(y,h)):l.push(Q);isFinite(e)&&(!P.G.isActive()||e<P.S)&&(P.S=e,P.G.start(h));P.T.GA()||(k=l.length,l=l.filter(function(J){var K;J=((K=J.actionProto)==null?void 0:K.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!VZj.includes(J)}),w=l.length<k,!P.G.isActive()&&w&&P.G.start(1));
l.length>0&&dRQ(P,l);return g.b(I,Oby(P),0)})},lq1=function(P){var v,l,e,h,z,m,Q;
return g.p(function(t){if(t.W==1)return g.b(t,vsQ(P),2);v=t.K;l=[];e=g.N(v);for(h=e.next();!h.done;h=e.next())z=h.value,m=g.Ct(z.key),Q=m.entityId,Egv(P.W,Q)||l.push(z);return g.b(t,Pny(P,l),0)})},TPx=function(P){P=P*1E3-Date.now();
return P>4E3?4E3:P},MZy=function(P,v){var l,e,h;
return g.p(function(z){l=g.N(v);for(e=l.next();!e.done;e=l.next()){h=e.value;var m=void 0,Q=void 0,t=((Q=h.action)==null?void 0:(m=Q.actionMetadata)==null?void 0:m.retryScheduleIntervalsInSeconds)||[1,2,4];m=1;h.retryScheduleIndex<t.length&&(m=t[h.retryScheduleIndex]);h.W=m*1E3+Date.now();h.retryScheduleIndex++}return g.b(z,ev1(P,v),0)})},WUA=function(P){var v;
return g.p(function(l){if(l.W==1)return g.b(l,d2(P.K,"offlineOrchestrationActionWrapperEntity"),2);v=l.K;return g.b(l,Pny(P,v),0)})},dRQ=function(P,v){v.length!==0&&v.forEach(function(l){l=nA(l);
l.retryScheduleIndex<3&&aby(P.W,[l])})},vsQ=function(P,v){var l;
return g.p(function(e){if(e.W==1)return g.b(e,d2(P.K,"offlineOrchestrationActionWrapperEntity",v),2);l=e.K;return e.return(l.filter(HC3))})},ev1=function(P,v){if(v.length===0)return Promise.resolve([]);
v=v.map(function(l){return Nq(l)});
return GXx(P.K,v)},hvo=function(P){this.j2=P;
this.W=void 0},zv3=function(P,v){var l,e,h,z;
return g.p(function(m){l=v.videoId;e=!0;if(v.captionTracks.length)h=c4x(v),P.W=new g.S_(P.j2,v,h);else if(v.t3)z=g.tcq(v),P.W=new g.X0(P.j2,v.t3,l,z,v.Cg,v.eventId),e=v.Cg;else return m.return();return m.return(new Promise(function(Q){var t;(t=P.W)==null||t.P1({E_:function(){return g.p(function(y){if(y.W==1)return g.b(y,P.E_(l,e),2);Q();g.nx(y)})},
w2:function(){}})}))})},m7m=function(P){var v;
return g.p(function(l){if(l.W==1)return g.b(l,sWv(P),2);v=l.K;return l.return(!!v&&v.length>0)})},jo=function(P){g.U.call(this);
this.W=P;this.K=this.W.observe(this.G.bind(this))},RvA=function(P,v){var l,e,h,z,m,Q,t;
return g.p(function(y){switch(y.W){case 1:if(v.length===0)return y.return([]);l=v.map(function(C){return g.ft(C,"transfer")});
return g.b(y,d2(P.W,"transfer",l),2);case 2:e=y.K;h=e.filter(HC3).map(function(C){return g.Ct(C.key).entityId});
z=v.filter(function(C){return h.indexOf(C)===-1});
if(z.length===0)return y.return([]);m=g.N(z);Q=m.next();case 3:if(Q.done){y.ac(5);break}t=Q.value;return g.b(y,cJA(t),4);case 4:Q=m.next();y.ac(3);break;case 5:return y.return(z)}})},yaQ=function(P,v,l,e,h,z){var m,Q,t;
return g.p(function(y){m="STREAM_TYPE_UNKNOWN";l.video&&l.audio?(m="STREAM_TYPE_AUDIO_AND_VIDEO",h1("unexpected stream type")):l.video&&!l.audio?m="STREAM_TYPE_VIDEO":!l.video&&l.audio&&(m="STREAM_TYPE_AUDIO");Q=g.ft(v,"offlineVideoStreams");t={numBytesDownloaded:h.toFixed(),numTotalBytes:z.toFixed(),streamType:m,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(e),itag:m==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(l.itag):void 0};return g.b(y,Mv(P,{mode:"readwrite",V7:!0},
function(C){var f=HD(C,Q,"offlineVideoStreams"),k=HD(C,g.ft(v,"transfer"),"transfer");return g.x6.all([f,k]).then(function(w){w=g.N(w);var I=w.next().value;w=w.next().value;if(!w)return ox(C,Q).then(function(){});
var J=QjA(I);I=tFY(I,e,t,Q);var K=OQ(C,I,"offlineVideoStreams");QjA(I)>J&&(w.lastProgressTimeMs=Date.now().toString());J=[K];w.offlineVideoStreams||(w.offlineVideoStreams=[]);w.offlineVideoStreams.indexOf(Q)===-1&&(w.offlineVideoStreams.push(Q),J.push(OQ(C,w,"transfer")));return g.x6.all(J)})}),0)})},CnG=function(P,v){var l,e,h,z,m;
return g.p(function(Q){if(Q.W==1)return l=g.ft(v,"offlineVideoStreams"),g.b(Q,V6(P,l,"offlineVideoStreams"),2);e=Q.K;if(!e||!e.streamsProgress)return Q.return();h=g.N(e.streamsProgress);for(z=h.next();!z.done;z=h.next())m=z.value,m.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",m.numTotalBytes!==m.numBytesDownloaded&&(m.numBytesDownloaded=m.numTotalBytes);return g.b(Q,Ts(P,e,"offlineVideoStreams"),0)})},tFY=function(P,v,l,e){if(P&&P.streamsProgress){e=P;
a:{v=v.itag+";"+v.xtags;for(var h=P.streamsProgress,z=0;z<h.length;z++){var m=JSON.parse(h[z].formatStreamBytes);if(m.itag+";"+m.xtags===v){h[z]=l;l=h;break a}}h.push(l);l=h}e.streamsProgress=l}else P={key:e,streamsProgress:[l]};return P},QjA=function(P){if(P==null?0:P.streamsProgress){var v=0;
P=P.streamsProgress;for(var l=0;l<P.length;l++){var e=P[l];isNaN(Number(e.numBytesDownloaded))?h1("stream progress bytes number invalid"):v+=Number(e.numBytesDownloaded)}return v}return 0},fqb=function(P,v,l,e){g.U.call(this);
var h=this;this.K=P;this.api=v;this.q5=l;this.QW=e;this.T=new g.PY;this.Y=new g.mr(function(){h.W&&h.W.transferState==="TRANSFER_STATE_TRANSFERRING"&&h.T.GA()&&((h.W.transferRetryCount||0)<3?Up(h.j,h.Z,!1,!1):iw(h.j,h.Z.videoDetails.videoId),h.Xl("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.Wg=this.kf=0;this.X=this.S=!1;this.Ic=g.ID(this.api.N().experiments,"html5_transfer_processing_logs_interval");this.Pg=new g.Z1(this);this.Kh={lYJ:function(){return h.Y},
wI3:function(){return h.QW},
vH:function(){return h.T}};
this.J5=this.K.observe(this.e1.bind(this));this.j=new KUm(v,this);this.h5=new hvo(v);this.T1=new jo(this.K);this.Hg=this.T.listen("publicytnetworkstatus-online",this.Pt.bind(this));this.wM=this.T.listen("publicytnetworkstatus-offline",this.kQ$.bind(this));this.X=this.api.N().V("html5_less_transfer_processing_logs");g.Z(this,this.Pg);this.Pg.C(v,"offlinetransferpause",this.Evc);g.Po(this.api.N())?this.G="mainVideoDownloadStateEntity":g.H$(this.api.N())&&(this.G="musicTrackDownloadMetadataEntity")},
gsy=function(P){return g.p(function(v){if(v.W==1)v=g.b(v,OCy(),2);
else{var l=P.T1;var e=g.p_();e=Object.keys(e);l=RvA(l,e);v=g.b(v,l,0)}return v})},Hc=function(P,v){v=v===void 0?!1:v;
var l;return g.p(function(e){if(e.W==1){if(P.W)throw Error("Already downloading a video");P.Wg=0;P.S=!1;return g.b(e,kRy(P),2)}return e.W!=4?(l=e.K,IOb(P.q5,!l),l&&P.T.GA()?v?g.b(e,new Promise(function(h){g.KG(h,1E3)}),4):e.ac(4):(!l&&P.W&&al(P),e.ac(0))):g.b(e,w9Q(P,l),0)})},$7G=function(P){return g.p(function(v){if(v.W==1)return P.Z?g.b(v,iw(P.j,P.Z.videoDetails.videoId),3):v.ac(0);
al(P);g.nx(v)})},IqQ=function(P,v){var l,e,h;
return g.p(function(z){switch(z.W){case 1:return g.NP(z,2),(l=!!v.captionTracks.length||!!v.t3)?g.b(z,m7m(v.videoId),4):z.return();case 4:return(e=z.K)?z.return():g.b(z,zv3(P.h5,v),5);case 5:g.uD(z,0);break;case 2:h=g.Kx(z),h1("Caption downloading error",h,v.cotn),g.nx(z)}})},w9Q=function(P,v){var l,e,h,z,m,Q;
return g.p(function(t){switch(t.W){case 1:if(P.S)return t.return();P.S=!0;P.W=v;l=g.Ct(P.W.key);e=l.entityId;h=void 0;if(P.W.transferState==="TRANSFER_STATE_TRANSFERRING")return g.b(t,Ep(P,e),7);if(P.W.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||P.W.transferRetryCount||P.W.hasLoggedFirstStarted){t.ac(3);break}return g.b(t,Ep(P,e),5);case 5:return h=t.K,P.W.hasLoggedFirstStarted=!0,g.b(t,D7G(P),6);case 6:D_b({videoId:e,qj:P.W,offlineModeType:h},void 0,void 0,!0);t.ac(3);break;case 7:h=t.K,
t1({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:e,qj:P.W,offlineModeType:h});case 3:return g.b(t,nsv(P),8);case 8:return z=null,g.NP(t,9),g.b(t,Nj1(P,v),11);case 11:z=t.K;P.Z=z;g.uD(t,10);break;case 9:return m=g.Kx(t),h1("error getting player response",m,v.cotn),g.b(t,P.Xl("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return t.return();case 10:return Q=cvd(P.api.N(),v.cotn,z),g.b(t,IqQ(P,Q),13);case 13:return g.b(t,qzd(Q.videoId),
14);case 14:Q.L1=t.K,bbA(P.j,Q,v.maximumDownloadQuality),P.Y.start(108E5),g.nx(t)}})},kRy=function(P){var v,l;
return g.p(function(e){if(e.W==1)return g.b(e,d2(P.K,"transfer"),2);v=e.K;l=v.filter(Jaj).sort(uxm);return l.length===0?e.return():e.return(l[0])})},nsv=function(P){var v,l,e;
return g.p(function(h){if(h.W==1){if(!P.W)return Wc(P,"onTransferStart"),h.return();P.Y.start(108E5);return g.b(h,Op(P,"TRANSFER_STATE_TRANSFERRING"),2)}v=P.W;return(e=((l=v)==null?0:l.key)?g.Ct(v.key).entityId:"")&&P.G?g.b(h,kp(e,P.G,P.K,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):h.ac(0)})},AJj=function(P){var v,l,e,h;
g.p(function(z){switch(z.W){case 1:if(!P.W){Wc(P,"onTransferPausedByUser");z.ac(2);break}v=P.W;P.Y.stop();return g.b(z,Op(P,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:e=((l=v)==null?0:l.key)?g.Ct(v.key).entityId:"";if(!e||!P.G){z.ac(4);break}return g.b(z,kp(e,P.G,P.K,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.b(z,Ep(P,e),6);case 6:h=z.K,n1A({videoId:e,qj:v,offlineModeType:h});case 2:al(P),Hc(P),g.nx(z)}})},YzG=function(P){var v,l,e;
g.p(function(h){if(h.W==1){if(!P.W)return Wc(P,"onTransferPausedByNetwork"),h.return();P.Y.stop();return g.b(h,Op(P,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(h.W!=3)return v=P.W,(e=((l=v)==null?0:l.key)?g.Ct(v.key).entityId:"")&&P.G?g.b(h,kp(e,P.G,P.K,"DOWNLOAD_STATE_PAUSED"),3):h.ac(3);al(P);g.nx(h)})},Kox=function(P){var v,l,e,h,z;
g.p(function(m){switch(m.W){case 1:if(!P.W)return Wc(P,"onTransferComplete"),m.return();v=P.W;P.Y.stop();if(!v||!P.Z){m.ac(2);break}l=cvd(P.api.N(),v.cotn,P.Z);return g.b(m,IqQ(P,l),2);case 2:return g.b(m,Op(P,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:h=((e=v)==null?0:e.key)?g.Ct(v.key).entityId:"";if(!h||!P.G){m.ac(5);break}return g.b(m,kp(h,P.G,P.K,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.b(m,CnG(P.K,h),7);case 7:return g.b(m,Ep(P,h),8);case 8:z=m.K,t1({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:h,qj:v,offlineModeType:z}),al(P),Hc(P),g.nx(m)}})},ca1=function(P,v,l){var e,h;
g.p(function(z){switch(z.W){case 1:if(!P.W)return Wc(P,"onTransferProgress: "+v),z.return();if(P.W.transferState==="TRANSFER_STATE_TRANSFERRING"){z.ac(2);break}return g.b(z,nsv(P),2);case 2:e=Date.now();if(!(e-P.kf>1E3)){z.ac(4);break}P.kf=e;return g.b(z,yaQ(P.K,l.videoId,l.K,l.A9,l.bytesDownloaded,l.W),5);case 5:if(P.X&&!(P.X&&e-P.Wg>P.Ic)){z.ac(4);break}P.Wg=e;return g.b(z,Ep(P,v),7);case 7:h=z.K,D_b({videoId:v,qj:P.W,offlineModeType:h},l.bytesDownloaded,l.W);case 4:P.Y.start(108E5),g.nx(z)}})},
qSb=function(P){var v=(P.W.transferRetryCount||0)<3;
v&&(P=P.W,P.transferRetryCount=(P.transferRetryCount||0)+1);return v},FoY=function(P,v){v=v===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":v;
var l,e,h,z;return g.p(function(m){if(m.W==1)return P.W||Wc(P,"setTransferToFailed: "+v),l="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",v==="TRANSFER_FAILURE_REASON_NETWORK"?l="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":v==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(l="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.b(m,Op(P,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",v),2);if(m.W!=3)return ma(P.QW,{entityKey:(e=P.W)==null?void 0:e.key,failureReason:l}),
h=P.W?g.Ct(P.W.key).entityId:"",g.b(m,Ep(P,h),3);z=m.K;var Q={videoId:h,qj:P.W,offlineModeType:z},t=v,y={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};t&&(y.transferFailureReason=t,y.failureReason=N1v(t));t1(y,Q);g.nx(m)})},Op=function(P,v,l,e){var h;
return g.p(function(z){if(z.W==1){if(!P.W)return Wc(P,"saveTransferState: "+v),z.return();P.W.transferState=v;P.W.failureReason=e;g.NP(z,2);return g.b(z,D7G(P,function(m){return l?EQ(m,"offlineVideoStreams",P.W.offlineVideoStreams).then(function(Q){for(var t=g.N(Q),y=t.next();!y.done;y=t.next())if((y=y.value)&&y.streamsProgress){y=g.N(y.streamsProgress);for(var C=y.next();!C.done;C=y.next())C.value.streamState=l}return qJ3(m,Q.filter(function(f){return!!f}),"offlineVideoStreams")}):g.x6.resolve(void 0)}),
4)}if(z.W!=2)return g.uD(z,0);
h=g.Kx(z);return h instanceof g.KR&&h.type==="QUOTA_EXCEEDED"?g.b(z,P.Xl("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):z.ac(0)})},D7G=function(P,v){var l;
return g.p(function(e){if(!P.W)return e.return();l=P.W;return g.b(e,Mv(P.K,{mode:"readwrite",V7:!0},function(h){var z=[OQ(h,l,"transfer")];v&&z.push(v(h));return g.x6.all(z)}),0)})},al=function(P){P.W=void 0;
P.Z=void 0;P.Y.stop()},Nj1=function(P,v){var l,e,h,z,m;
return g.p(function(Q){if(Q.W==1)return l=g.Ct(v.key),e=l.entityId,h=g.ft(e,"playbackData"),g.b(Q,V6(P.K,h,"playbackData"),2);z=Q.K;if((m=z)==null?0:m.playerResponseJson)return Q.return(JSON.parse(z.playerResponseJson));throw Error("No PlayerResponse found");})},Wc=function(P,v){P.api.f0("woffle",{mcte:v});
h1("missing current transfer entity.")},Ep=function(P,v){var l,e,h;
return g.p(function(z){if(z.W==1)return g.b(z,V6(P.K,g.ft(v,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);l=z.K;return z.return((h=(e=l)==null?void 0:e.offlineModeType)!=null?h:void 0)})},Jaj=function(P){return Aa3[P.transferState]!==void 0},uxm=function(P,v){var l=Aa3[P.transferState],e=Aa3[v.transferState];
return l!==e?l-e:Number(P.enqueuedTimestampMs)-Number(v.enqueuedTimestampMs)},ol=function(P,v){var l=this;
this.O$=P;this.api=v;this.T=new g.PY;this.Z=new g.J4;this.Kh={rU:function(){return l.G.Kh.rU()},
vH:function(){return l.T},
nL5:function(){return l.G},
Zz:function(){return l.Zz()},
l0:function(){return l.l0()},
SU:function(){return l.SU()},
X1:function(){return l.X1()},
Bc:function(){return l.Bc()},
qY:function(e){return l.qY(e)}};
this.G=new g1y(function(){return YSv(l)},function(){l.SU()},this.api.QK(),this.api.V.bind(this.api));
this.W=new zC(this.api);kUj(this.G)},YSv=function(P){return g.p(function(v){P.api.C0("onOrchestrationBecameLeader");
return g.b(v,P.l0(),0)})},x71=function(P){var v,l;
return g.p(function(e){if(e.W==1)return g.b(e,Pc(),2);if(e.W!=3){v=e.K;if(!v)return h1("PES is undefined"),e.return();P.K=new fqb(v,P.api,P.G,P.W);l=P.Zv(v);return g.b(e,og3(v,l,P.G,P.W,P.O$),3)}P.j=e.K;return g.b(e,bTb(P),0)})},bTb=function(P){var v;
return g.p(function(l){switch(l.W){case 1:if(!P.K)return h1("transferManager is undefined"),l.return();if(P.K.W){l.ac(2);break}return g.b(l,Hc(P.K),2);case 2:if(!P.O$.V("woffle_enable_main_downloads_library")){l.ac(4);break}return g.b(l,P.hW(),4);case 4:if(!P.O$.V("html5_offline_playback_position_sync")){l.ac(6);break}return g.b(l,P.WY(),7);case 7:return g.b(l,P.qY(864E5),6);case 6:return g.b(l,P.refreshAllStaleEntities(43200,!0),9);case 9:return g.b(l,P.RW(),10);case 10:if(!P.O$.V("html5_retry_downloads_for_expiration")){l.ac(11);
break}return g.b(l,P.Bc(),11);case 11:return P.S=g.cM(function(){P.refreshAllStaleEntities(43200,!0);P.RW()},9E5),g.zz(g.RG(),function(){return P.X1()}),g.b(l,Pc(),13);
case 13:return v=l.K,g.b(l,fO3(v),14);case 14:wk1(P.G),g.nx(l)}})},p9Y=function(){var P,v,l,e,h,z;
return g.p(function(m){switch(m.W){case 1:return g.b(m,Pc(),2);case 2:P=m.K;if(!P)return m.return([]);v=Date.now()/1E3;return g.b(m,d2(P,"offlineVideoPolicy"),3);case 3:l=m.K,e=g.N(l),h=e.next();case 4:if(h.done){m.ac(6);break}z=h.value;if(!(z.expirationTimestamp&&Number(z.expirationTimestamp)<v)){m.ac(5);break}z.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";z.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.b(m,Ts(P,z,"offlineVideoPolicy"),5);
case 5:h=e.next();m.ac(4);break;case 6:return m.return(l.map(function(Q){return Q.key}))}})},sp=function(P,v,l,e,h){var z,m,Q;
return g.p(function(t){if(t.W==1)return g.b(t,Pc(),2);z=t.K;if(!z)return t.return([]);m=v.map(function(y){var C=g.ft(y,l);C={actionType:e,entityKey:C,actionMetadata:Object.assign({},qmQ(),h)};e!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(C.actionMetadata.priority=0);y=new DK(l,y,C);return Nq(y)});
Q=GXx(z,m);kUj(P.G);return t.return(Q)})},Loy=function(P,v,l,e){var h,z,m,Q,t,y,C,f;
return g.p(function(k){switch(k.W){case 1:h=[],z=g.N(v),m=z.next();case 2:if(m.done){k.ac(4);break}Q=m.value;if(Q.upToDate||l&&!Q.shouldAutoSyncMetadata||!Q.playlistId){k.ac(3);break}t={};switch(e){case "mainPlaylistEntity":y={nextAutoRefreshIntervalSeconds:Q.checkInSeconds,autoSync:l};t={mainPlaylistEntityActionMetadata:y};break;case "musicPlaylist":C={autoSync:l},t={musicPlaylistEntityActionMetadata:C}}return g.b(k,sp(P,[Q.playlistId],e,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",t),6);case 6:(f=
k.K)&&h.push.apply(h,g.u(f));case 3:m=z.next();k.ac(2);break;case 4:return k.return(h)}})},SSd=function(P,v){var l;
return g.p(function(e){return v.length?(l=qmQ(),g.Oc(l,XJ,{isEnqueuedForExpiredStreamUrlRefetch:!0}),P.api.f0("qrd",{v:v.length}),e.return(sp(P,v,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",l))):e.return([])})},GRm=function(P,v,l){this.W=P;
this.O$=v;this.G=l},iTY=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A;
return g.p(function(x){switch(x.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,z=[],g.NP(x,2),g.b(x,X9x(P,h),4);case 4:z=x.K;if(!(P.O$.V("woffle_enable_main_downloads_library")&&((m=z)==null?0:m.length))){x.ac(5);break}return g.b(x,U_Y(P.W,[v.entityKey]),5);case 5:g.uD(x,3);break;case 2:return Q=g.Kx(x),t="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Q instanceof g.KR&&Q.type==="QUOTA_EXCEEDED"?(t="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):h1("Playlist add error"),x.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,t,y));case 3:C=[];if(!P.O$.V("html5_offline_prevent_redownload_downloaded_video")){x.ac(7);break}return g.b(x,Kwb(P.W,"mainVideoEntity",z),8);case 8:z=x.K;case 7:if((f=z)==null?0:f.length)for(k=g.N(z),w=k.next();!w.done;w=k.next())if(I=w.value,J=I.offlineVideoData,K=void 0,(K=J)==null?0:K.videoId)q=void 0,A=Number(((q=v.actionMetadata)==null?void 0:q.priority)||
0)+1,C.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",J.videoId,"mainVideoEntity",A,rv,Bjx(v,J,h)));return x.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,C))}})},ZTx=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y,L,X,lD,zW,mD,G,Cx,$a,tq,px,go,jx,kw,Ey,Z7,ya,St,Wr,fU,ae,jw,Hi,NV,gY,p7,gK,L7,BN,iI,A4,Vv,E1,zV,KT,E5;
return g.p(function(wL){switch(wL.W){case 1:return l=yZ(v),e=v.entityKey,h=g.Ct(e).entityId,z=[],m=!1,h==="!*$_ALL_ENTITIES_!*$"?(m=!0,g.b(wL,d2(P.W,"mainPlaylistEntity"),5)):g.b(wL,V6(P.W,e,"mainPlaylistEntity"),4);case 4:(Q=wL.K)&&z.push(Q);wL.ac(3);break;case 5:z=wL.K;case 3:if((t=z)==null||!t.length)return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));y=g.a(v.actionMetadata,U7y);f=(C=y)==null?void 0:C.nextAutoRefreshIntervalSeconds;w=(k=y)==null?void 0:k.autoSync;I=[];K=J=
!0;q=!1;if(!m&&w===!1){wL.ac(6);break}g.NP(wL,7);return g.b(wL,d_y(0,!!w,!0,z),9);case 9:I=wL.K;g.uD(wL,8);break;case 7:A=g.Kx(wL);if(!(A instanceof Error&&A.message==="No data")){A instanceof Error&&A.message==="Empty response body"&&h1(A.message);wL.ac(8);break}return h==="!*$_ALL_ENTITIES_!*$"?g.b(wL,LwA(P.W,v,P.G,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.b(wL,x_m(h,P.W,v,P.G),8);case 8:if(!I.length||!m&&I[0].playlistId!==h)return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l));case 6:if(m){x=[];S=g.N(I);for(B=S.next();!B.done;B=S.next())E=B.value,E.upToDate||w&&!E.shouldAutoSyncMetadata||!E.playlistId||(r={nextAutoRefreshIntervalSeconds:E.checkInSeconds,autoSync:w},x.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",E.playlistId,"mainPlaylistEntity",0,rv,{mainPlaylistEntityActionMetadata:r})));return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,x))}I.length&&(hq=I[0],q=!!hq.upToDate,w&&(J=(R7=hq.shouldAutoSyncMetadata)!=null?R7:!0,K=(Pw=hq.shouldAutoSyncVideos)!=
null?Pw:!0,hq.checkInSeconds&&(f=hq.checkInSeconds)));if(q||!J)return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));H=[];T=z[0];if(!T.downloadState){n=void 0;wL.ac(15);break}return g.b(wL,V6(P.W,T.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:n=wL.K;case 15:return W=n,K1=((du=W)==null?0:du.addedTimestampMillis)?String(W.addedTimestampMillis):void 0,g.NP(wL,17),g.b(wL,X9x(P,h,K1,f),19);case 19:H=wL.K;g.uD(wL,18);break;case 17:f1=g.Kx(wL);if(!(f1 instanceof Error&&
f1.message==="No data for playlist")){if(f1 instanceof Error&&f1.message==="Empty response body for playlist")h1(f1.message);else return Aq="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",MP="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",f1 instanceof g.KR&&f1.type==="QUOTA_EXCEEDED"&&(Aq="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",MP="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,Aq,MP));wL.ac(18);
break}return g.b(wL,x_m(h,P.W,v,P.G),18);case 18:if(!K)return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));lY=[];$3=new Map;if((c=H)==null?0:c.length)for(F=g.N(H),Y=F.next();!Y.done;Y=F.next())L=Y.value,X=L.offlineVideoData,lD=void 0,((lD=X)==null?0:lD.videoId)&&$3.set(X.videoId,X);zW=new Map;mD=[];if((G=T)==null?0:(Cx=G.videos)==null?0:Cx.length)for($a=g.N(T.videos),tq=$a.next();!tq.done;tq=$a.next())if(px=tq.value,go=JSON.parse(g.Ct(px).entityId),jx=go.videoId)$3.has(jx)?(zW.set(jx,
$3.get(jx)),$3.delete(jx)):mD.push(jx);Ey=Number(((kw=v.actionMetadata)==null?void 0:kw.priority)||0)+1;Z7=g.N($3.entries());for(ya=Z7.next();!ya.done;ya=Z7.next())St=ya.value,Wr=g.N(St),fU=Wr.next().value,ae=Wr.next().value,jw=fU,Hi=ae,lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",jw,"mainVideoEntity",Ey,rv,Bjx(v,Hi,h)));NV=g.N(zW.entries());for(gY=NV.next();!gY.done;gY=NV.next())p7=gY.value,gK=g.N(p7),L7=gK.next().value,BN=gK.next().value,iI=L7,A4=BN,lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
iI,"mainVideoEntity",Ey,rv,Bjx(v,A4,h)));Vv=g.N(mD);for(E1=Vv.next();!E1.done;E1=Vv.next())zV=E1.value,KT={playlistId:h},E5={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:KT},lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",zV,"mainVideoEntity",0,rv,E5));return wL.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,lY))}})},jjY=function(P,v){var l,e,h,z;
return g.p(function(m){switch(m.W){case 1:return l=yZ(v),g.NP(m,2),e=g.Ct(v.entityKey).entityId,e==="!*$_ALL_ENTITIES_!*$"?g.b(m,LwA(P.W,v,P.G,(h=v.actionMetadata)==null?void 0:(z=h.offlineLoggingData)==null?void 0:z.offlineDeleteReason),5):g.b(m,x_m(e,P.W,v,P.G),6);case 6:if(!P.O$.V("woffle_enable_main_downloads_library")){m.ac(5);break}return g.b(m,ZnG(P.W,v.entityKey),5);case 5:g.uD(m,3);break;case 2:return g.Kx(m),m.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return m.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l))}})},X9x=function(P,v,l,e){var h,z,m,Q,t,y,C;
return g.p(function(f){switch(f.W){case 1:return g.b(f,T1A([v]),2);case 2:return h=f.K,g.b(f,aq3(P,h[0],l,e),3);case 3:return z=f.K,m=z.mainPlaylistEntity,Q=z.mvW,y=Ymm(m,(t=Q)==null?void 0:t.avatar),g.NP(f,4),g.b(f,uw(y),6);case 6:g.uD(f,5);break;case 4:C=g.Kx(f),C instanceof Error&&C.message==="Failed to fetch"&&h1(C.message);case 5:return f.return(h[0].videos)}})},aq3=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S;
return g.p(function(B){switch(B.W){case 1:h=Date.now().toString();l||(l=h);z=v.videos;m=v.playlistId;Q=[];t=[];if(z)for(y=g.N(z),C=y.next();!C.done;C=y.next()){f=C.value;k=f.offlineVideoData;if(!k||!k.videoId)throw h1("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");w=k.videoId;I={videoId:w,playlistId:m};J={id:g.ft(JSON.stringify(I),"mainPlaylistVideoEntity"),video:g.ft(w,"mainVideoEntity")};Q.push(J);t.push(J.id)}q={key:g.ft(m,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:l,lastSyncedTimestampMillis:h};A={key:g.ft(m,"mainPlaylistEntity"),playlistId:m,videos:t,title:v.title,thumbnailStyleData:HTA(v),visibility:EsA(v),downloadState:q.key};v.channel&&(x=v.channel.offlineChannelData,K=Wod(g.ft(m,"ytMainChannelEntity"),x),A.channelOwner=K.id);((S=A)==null?0:S.entityMetadata)?(A.entityMetadata.offlineLastModifiedTimestampSeconds=v.lastModifiedTimestamp,e&&(A.entityMetadata.nextAutoRefreshIntervalSeconds=String(e))):A&&(A.entityMetadata={nextAutoRefreshIntervalSeconds:e?
String(e):void 0,offlineLastModifiedTimestampSeconds:v.lastModifiedTimestamp});g.NP(B,2);return g.b(B,Mv(P.W,{mode:"readwrite",V7:!0},function(E){var r=OQ(E,A,"mainPlaylistEntity"),hq=OQ(E,q,"mainPlaylistDownloadStateEntity");r=[r,hq];hq=g.N(Q);for(var R7=hq.next();!R7.done;R7=hq.next())r.push(OQ(E,R7.value,"mainPlaylistVideoEntity"));K&&r.push(OQ(E,K,"ytMainChannelEntity"));return g.x6.all(r)}),4);
case 4:g.uD(B,3);break;case 2:throw g.Kx(B),h1("PES failure for playlist"),Error("PES failure for playlist");case 3:return B.return({mainPlaylistEntity:A,mvW:K,Am0:Q})}})},Wod=function(P,v){return{id:P,
channelId:v.channelId,title:v.title,avatar:v.thumbnail}},HTA=function(P){var v=[],l=P.videos;
l&&l.length>0&&v.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:l[0].offlineVideoData.thumbnail}}});if((P=P.additionalMetadadatas)&&P.length>0)for(P=g.N(P),l=P.next();!l.done;l=P.next()){var e=l.value.offlineBundleItemPlaylistData,h=void 0;l=(h=e)==null?void 0:h.style;h=void 0;e={collageThumbnail:{coverThumbnail:(h=e)==null?void 0:h.coverThumbnail}};switch(l){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":v.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:e});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":v.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:e});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":v.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:e});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":v.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:e})}}return v},EsA=function(P){switch(P.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},Bjx=function(P,v,l){v={offlineVideoData:v,
playlistId:l};if(P=g.a(P.actionMetadata,U7y))v.maximumDownloadQuality=P.maximumDownloadQuality;return{mainVideoEntityActionMetadata:v}},OTv=function(P,v,l){this.W=P;
this.O$=v;this.G=l},rax=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I;
return g.p(function(J){switch(J.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,z=g.a(v.actionMetadata,Mq),Q=!((m=z)==null?0:m.playlistId),g.NP(J,2),g.b(J,osj(P,h,void 0,(t=z)==null?void 0:t.offlineVideoData,Q),4);case 4:g.uD(J,3);break;case 2:return y=g.Kx(J),C="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",f="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",y instanceof g.KR&&y.type==="QUOTA_EXCEEDED"&&(C="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",f="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
J.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,C,f));case 3:k=1;k=Number(((w=v.actionMetadata)==null?void 0:w.priority)||0)+1;var K=(K=g.a(v.actionMetadata,Mq))?{playbackDataActionMetadata:{maximumDownloadQuality:K.maximumDownloadQuality}}:void 0;I=So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",h,"playbackData",k,sjy,K);return J.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,[I]))}})},MFY=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A;
return g.p(function(x){switch(x.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,g.b(x,V6(P.W,v.entityKey,"mainVideoEntity"),2);case 2:z=x.K;if(!z){m=void 0;x.ac(3);break}return g.b(x,V6(P.W,z.downloadState,"mainVideoDownloadStateEntity"),4);case 4:m=x.K;case 3:Q=m;if(!z||!Q)return x.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));g.NP(x,5);return g.b(x,osj(P,h,Q.addedTimestampMillis,(y=g.a(v.actionMetadata,Mq))==null?void 0:y.offlineVideoData),7);case 7:C=1;C=Number(((f=
v.actionMetadata)==null?void 0:f.priority)||0)+1;t=So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",h,"playbackData",C,sjy);g.uD(x,6);break;case 5:k=g.Kx(x);if(!(k instanceof Error&&k.message==="No data")){if(k instanceof Error&&k.message==="Empty response body")h1(k.message);else return w="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",I="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",k instanceof g.KR&&k.type==="QUOTA_EXCEEDED"&&(w="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
I="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),x.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,w,I));x.ac(6);break}return g.b(x,qq(P.W,h),9);case 9:J=x.K;K=g.a(v.actionMetadata,Mq);if(A=(q=K)==null?void 0:q.playlistId)J.playlistId=A;J.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.b(x,KA(h,P.W,v,P.G,J),6);case 6:return x.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,t?[t]:void 0))}})},Tjm=function(P,v){var l,e,h,z,m,Q,t,y,C,f;
return g.p(function(k){switch(k.W){case 1:return l=yZ(v),g.NP(k,2),e=g.Ct(v.entityKey).entityId,e==="!*$_ALL_ENTITIES_!*$"?g.b(k,LwA(P.W,v,P.G,(C=v.actionMetadata)==null?void 0:(f=C.offlineLoggingData)==null?void 0:f.offlineDeleteReason),5):g.b(k,qq(P.W,e),6);case 6:h=k.K;z=g.a(v.actionMetadata,Mq);if(Q=(m=z)==null?void 0:m.playlistId)h.playlistId=Q;h.offlineDeleteReason=(t=v.actionMetadata)==null?void 0:(y=t.offlineLoggingData)==null?void 0:y.offlineDeleteReason;return g.b(k,KA(e,P.W,v,P.G,h),7);
case 7:if(!P.O$.V("woffle_enable_main_downloads_library")){k.ac(5);break}return g.b(k,ZnG(P.W,v.entityKey),5);case 5:g.uD(k,3);break;case 2:return g.Kx(k),k.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return k.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l))}})},osj=function(P,v,l,e,h){var z,m,Q,t,y,C;
return g.p(function(f){switch(f.W){case 1:if(z=e){f.ac(2);break}return g.b(f,M8b([v]),3);case 3:m=f.K,z=m[0];case 2:return g.b(f,VFy(P,z,l,h),4);case 4:Q=f.K;t=Q.mainVideoEntity;y=Q.channelEntity;g.NP(f,5);var k=Il(t.thumbnail),w=Il(y.avatar);return g.b(f,uw(k.concat(w)),7);case 7:g.uD(f,0);break;case 5:C=g.Kx(f),C instanceof Error&&C.message==="Failed to fetch"&&h1(C.message),g.nx(f)}})},VFy=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k,w,I,J,K;
return g.p(function(q){switch(q.W){case 1:l||(l=Date.now().toString());z=(h=v.channel)==null?void 0:h.offlineChannelData;m={id:g.ft(v.videoId,"ytMainChannelEntity"),channelId:z.channelId,title:z.title,avatar:z.thumbnail};Q={key:g.ft(v.videoId,"mainVideoDownloadStateEntity"),playbackData:g.ft(v.videoId,"playbackData"),addedTimestampMillis:l,videoDownloadContextEntity:g.ft(v.videoId,"videoDownloadContextEntity")};t={key:g.ft(v.videoId,"videoPlaybackPositionEntity"),videoId:v.videoId,lastPlaybackPositionSeconds:"0"};
P.O$.V("html5_offline_playback_position_sync")&&(y={playbackPosition:t.key});C=g.ft(v.videoId,"mainVideoEntity");f={key:C,videoId:v.videoId,title:v.title,thumbnail:v.thumbnail,localizedStrings:{viewCount:v.shortViewCountText},userState:y,lengthSeconds:v.lengthSeconds?Number(v.lengthSeconds):void 0,publishedTimestampMillis:v.publishedTimestamp?(Number(v.publishedTimestamp)*1E3).toString():void 0,formattedDescription:v.description,owner:m.id,downloadState:Q.key};if(!P.O$.V("woffle_enable_main_downloads_library")||
!e){q.ac(2);break}return g.b(q,inb(P.W,[C]),3);case 3:if(I=q.K)k=I.mainDownloadsLibraryEntity,w=I.mainDownloadsListEntity;case 2:return K=um1,J={key:g.ft(v.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.Oc(Q,K,J),g.b(q,Mv(P.W,{mode:"readwrite",V7:!0},function(A){var x=OQ(A,m,"ytMainChannelEntity"),S=OQ(A,Q,"mainVideoDownloadStateEntity"),B=OQ(A,f,"mainVideoEntity");x=[x,S,B];P.O$.V("html5_offline_playback_position_sync")&&(S=OQ(A,t,"videoPlaybackPositionEntity"),
x.push(S));k&&(S=OQ(A,k,"mainDownloadsLibraryEntity"),x.push(S));w&&(S=OQ(A,w,"mainDownloadsListEntity"),x.push(S));J&&(A=OQ(A,J,"downloadStatusEntity"),x.push(A));return g.x6.all(x)}),4);
case 4:return q.return({mainVideoEntity:f,channelEntity:m})}})},d7Y=function(P,v,l){this.W=P;
this.O$=v;this.G=l},vkb=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T;
return g.p(function(n){switch(n.W){case 1:return l=yZ(v),e=[],g.b(n,Za.getInstance(),2);case 2:h=n.K;if(!h){n.ac(3);break}return g.b(n,h.get("sdois"),4);case 4:return z=n.K,g.b(n,(Q=h)==null?void 0:Q.get("lmqf"),5);case 5:m=n.K;case 3:g.NP(n,6);if(z===void 0)throw Error("prefStorage or opt-in state is undefined");t=[];if(z){n.ac(8);break}return g.b(n,B13(P.W),9);case 9:t=n.K,t.reverse();case 8:if(!t.length){n.ac(10);break}y=g.N(t);C=y.next();case 11:if(C.done){n.ac(10);break}f=C.value;if(!f){n.ac(12);
break}k=g.Ct(f).entityId;return g.b(n,qq(P.W,k),14);case 14:return w=n.K,w.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.b(n,KA(k,P.W,{entityKey:f,actionType:v.actionType},P.G,w),12);case 12:C=y.next();n.ac(11);break;case 10:return g.b(n,vgb(z,(I=m)!=null?I:"SD"),16);case 16:return J=n.K,g.b(n,Smy(J),17);case 17:K=Xkv(J);if(!P.O$.V("woffle_enable_main_downloads_library")){n.ac(18);break}if(z){n.ac(19);break}return g.b(n,ZnG(P.W,g.BV),19);case 19:return g.b(n,U_Y(P.W,[g.BV]),18);
case 18:if((q=K)==null?0:q.length)for(A=g.N(K),x=A.next();!x.done;x=A.next())if(B=S=x.value,E=B.actionType,r=B.entityKey,hq=B.actionMetadata,E&&r&&hq&&!g.a(hq,P$m)){E==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(hq.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(R7=g.a(S.actionMetadata,Mq))R7.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",S.actionMetadata=Object.assign({},S.actionMetadata,{mainVideoEntityActionMetadata:R7});e.push(S)}g.uD(n,7);break;
case 6:return Pw=g.Kx(n),H="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Pw instanceof g.KR&&Pw.type==="QUOTA_EXCEEDED"&&(H="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),n.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,H,T));case 7:return n.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,e))}})},lEv=function(){ol.apply(this,arguments);
this.X="mainVideoEntity"},eem=function(P,v,l){v=v===void 0?43200:v;
l=l===void 0?!0:l;var e=e===void 0?!1:e;var h,z,m;return g.p(function(Q){switch(Q.W){case 1:if(!P.T.GA())return Q.return([]);h=[];g.NP(Q,2);return g.b(Q,d_y(v,l,e),4);case 4:h=Q.K;g.uD(Q,3);break;case 2:z=g.Kx(Q),z instanceof Error&&z.message==="No data"||z instanceof Error&&z.message==="Empty response body"&&h1(z.message);case 3:return m=Loy(P,h,l,"mainPlaylistEntity"),Q.return(m)}})},hem=function(P,v,l,e){e=e===void 0?!1:e;
var h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A;return g.p(function(x){switch(x.W){case 1:return h=[],g.b(x,Pxy(),2);case 2:return(z=x.K)||e?g.b(x,lby(v,l),3):x.return([]);case 3:m=x.K;if((Q=m)==null||!Q.length)return x.return([]);t={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};y=g.N(m);C=y.next();case 4:if(C.done){x.ac(6);break}k=f=C.value;w=k.actionType;I=k.entityKey;J=k.actionMetadata;if(!(w&&I&&J)||g.a(J,P$m)){x.ac(5);break}w==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(J.offlineLoggingData=
t);K=g.Ct(I);q=K.entityId;return g.b(x,sp(P,[q],"mainVideoEntity",w,J),8);case 8:A=x.K,h=h.concat(A);case 5:C=y.next();x.ac(4);break;case 6:return x.return(h)}})},zeY=function(P,v){this.W=P;
this.G=v},Red=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q;
return g.p(function(A){switch(A.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,z=[],g.NP(A,2),g.b(A,mFo(P,h),4);case 4:z=A.K;if((m=z)==null||!m.length){A.ac(5);break}return g.b(A,Wwy(P.W,v.entityKey),5);case 5:g.uD(A,3);break;case 2:return Q=g.Kx(A),t="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Q instanceof g.KR&&Q.type==="QUOTA_EXCEEDED"&&(t="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
A.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,t,y));case 3:return C=[],g.b(A,Kwb(P.W,"musicTrack",z),7);case 7:z=A.K;if(z.length)for(f=g.N(z),k=f.next();!k.done;k=f.next())if(w=k.value,I=w.offlineVideoData,J=void 0,(J=I)==null?0:J.videoId)K=void 0,q=Number(((K=v.actionMetadata)==null?void 0:K.priority)||0)+1,C.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",I.videoId,"musicTrack",q,TC,bw(v,I,h)));return A.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,C))}})},
QXy=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y,L,X,lD,zW,mD,G,Cx,$a,tq,px,go,jx,kw,Ey,Z7,ya,St,Wr,fU,ae;
return g.p(function(jw){switch(jw.W){case 1:return l=yZ(v),e=v.entityKey,h=g.Ct(e).entityId,z=[],m=!1,h==="!*$_ALL_ENTITIES_!*$"?(m=!0,g.b(jw,d2(P.W,"musicAlbumRelease"),5)):g.b(jw,V6(P.W,e,"musicAlbumRelease"),4);case 4:(Q=jw.K)&&z.push(Q);jw.ac(3);break;case 5:z=jw.K;case 3:if((t=z)==null||!t.length)return jw.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));if(m){y=[];C=g.N(z);for(f=C.next();!f.done;f=C.next())k=f.value,w=g.Ct(k.id).entityId,y.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
w,"musicAlbumRelease",0,TC));return jw.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,y))}I=[];J=z[0];K=void 0;if(!J.downloadMetadata){jw.ac(6);break}return g.b(jw,V6(P.W,J.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:q=jw.K,K=Number((x=(A=q)==null?void 0:A.addedTimestampMillis)!=null?x:"0")/1E3;case 6:return g.NP(jw,8),g.b(jw,mFo(P,h,(S=K)==null?void 0:S.toString()),10);case 10:I=jw.K;g.uD(jw,9);break;case 8:B=g.Kx(jw);if(!(B instanceof Error&&B.message===
"No data")){if(B instanceof Error&&B.message==="Empty response body")h1(B.message);else return E="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",r="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.KR&&B.type==="QUOTA_EXCEEDED"&&(E="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",r="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),jw.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,E,r));jw.ac(9);break}return g.b(jw,A1(h,"musicAlbumRelease",P.W,
v,P.G),9);case 9:hq=[];R7=new Map;if((Pw=I)==null?0:Pw.length)for(H=g.N(I),T=H.next();!T.done;T=H.next())n=T.value,W=n.offlineVideoData,du=void 0,((du=W)==null?0:du.videoId)&&R7.set(W.videoId,W);K1=new Map;f1=[];if((Aq=J)==null?0:(MP=Aq.tracks)==null?0:MP.length)for(lY=g.N(J.tracks),$3=lY.next();!$3.done;$3=lY.next())if(c=$3.value,F=g.Ct(c).entityId)R7.has(F)?(K1.set(F,R7.get(F)),R7.delete(F)):f1.push(F);L=Number(((Y=v.actionMetadata)==null?void 0:Y.priority)||0)+1;X=g.N(R7.entries());for(lD=X.next();!lD.done;lD=
X.next())zW=lD.value,mD=g.N(zW),G=mD.next().value,Cx=mD.next().value,$a=G,tq=Cx,hq.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",$a,"musicTrack",L,TC,bw(v,tq)));px=g.N(K1.entries());for(go=px.next();!go.done;go=px.next())jx=go.value,kw=g.N(jx),Ey=kw.next().value,Z7=kw.next().value,ya=Ey,St=Z7,hq.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",ya,"musicTrack",L,TC,bw(v,St)));Wr=g.N(f1);for(fU=Wr.next();!fU.done;fU=Wr.next())ae=fU.value,hq.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",ae,
"musicTrack",0,TC));return jw.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,hq))}})},tdQ=function(P,v){var l,e;
return g.p(function(h){switch(h.W){case 1:return l=yZ(v),g.NP(h,2),e=g.Ct(v.entityKey).entityId,e==="!*$_ALL_ENTITIES_!*$"?g.b(h,Yp(P.W,v,P.G),5):g.b(h,A1(e,"musicAlbumRelease",P.W,v,P.G),6);case 6:return g.b(h,On1(P.W,v.entityKey),5);case 5:g.uD(h,3);break;case 2:return g.Kx(h),h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},mFo=function(P,v,l){var e,h,z;
return g.p(function(m){switch(m.W){case 1:return g.b(m,T1A([v]),2);case 2:return e=m.K,g.b(m,y8b(P,e[0],l),3);case 3:return h=m.K,z=Il(h.thumbnailDetails),g.b(m,uw(z),4);case 4:return m.return(e[0].videos)}})},y8b=function(P,v,l){var e,h,z,m,Q,t,y,C,f,k,w,I,J,K;
return g.p(function(q){if(q.W==1){e=v.additionalMetadadatas;h=void 0;if(e&&e.length>0)for(z=g.N(e),m=z.next();!m.done;m=z.next())if(Q=m.value,Q.offlineMusicPlaylistData){h=Q.offlineMusicPlaylistData;break}t=v.playlistId;y=o1Q(v);C=y.q3;f=y.o1;k=l?(Number(l)*1E3).toString():Date.now().toString();w=v.lastModifiedTimestamp?(Number(v.lastModifiedTimestamp)*1E3).toString():"0";I={id:g.ft(t,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:f,lastModifiedTimestampMillis:w,addedTimestampMillis:k,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};J={id:g.ft(t,"musicAlbumRelease"),title:v.title,audioPlaylistId:t,trackCount:v.totalVideoCount,tracks:C,downloadMetadata:I.id};h&&(J.thumbnailDetails=(K=h.albumHqThumbnail)!=null?K:h.albumArtistThumbnail,J.artistDisplayName=h.albumArtistDisplayName,J.releaseDate=h.albumReleaseDate,J.contentRating={explicitType:h.albumReleaseExplicitType},J.releaseType=h.albumReleaseType);return g.b(q,Mv(P.W,{mode:"readwrite",V7:!0},function(A){var x=OQ(A,J,"musicAlbumRelease");
A=OQ(A,I,"musicAlbumReleaseDownloadMetadataEntity");return g.x6.all([x,A])}),2)}return q.return(J)})},C$b=function(P,v){this.W=P;
this.G=v},gky=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q;
return g.p(function(A){switch(A.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,z=[],g.NP(A,2),g.b(A,fEy(P,h),4);case 4:z=A.K;if((m=z)==null||!m.length){A.ac(5);break}return g.b(A,Wwy(P.W,v.entityKey),5);case 5:g.uD(A,3);break;case 2:return Q=g.Kx(A),t="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Q instanceof g.KR&&Q.type==="QUOTA_EXCEEDED"&&(t="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
A.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,t,y));case 3:return C=[],g.b(A,Kwb(P.W,"musicTrack",z),7);case 7:z=A.K;if(z.length)for(f=g.N(z),k=f.next();!k.done;k=f.next())if(w=k.value,I=w.offlineVideoData,J=void 0,(J=I)==null?0:J.videoId)K=void 0,q=Number(((K=v.actionMetadata)==null?void 0:K.priority)||0)+1,C.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",I.videoId,"musicTrack",q,VZ,bw(v,I,h)));return A.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,C))}})},
klv=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3,c,F,Y,L,X,lD,zW,mD,G,Cx,$a,tq,px,go,jx,kw,Ey,Z7,ya,St,Wr,fU,ae,jw,Hi,NV,gY,p7,gK,L7,BN,iI,A4,Vv,E1;
return g.p(function(zV){switch(zV.W){case 1:return l=yZ(v),e=v.entityKey,h=g.Ct(e).entityId,z=[],m=!1,h==="!*$_ALL_ENTITIES_!*$"?(m=!0,g.b(zV,d2(P.W,"musicPlaylist"),5)):g.b(zV,V6(P.W,e,"musicPlaylist"),4);case 4:(Q=zV.K)&&z.push(Q);zV.ac(3);break;case 5:z=zV.K;case 3:if((t=z)==null||!t.length)return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));y=g.a(v.actionMetadata,sFy);f=(C=y)==null?void 0:C.autoSync;k=[];I=w=!0;J=!1;K=void 0;if(!m&&f===!1){zV.ac(6);break}g.NP(zV,7);return g.b(zV,
e3o(0,!!f,!0,z),9);case 9:k=zV.K;g.uD(zV,8);break;case 7:q=g.Kx(zV);if(!(q instanceof Error&&q.message==="No data")){q instanceof Error&&q.message==="Empty response body"&&h1(q.message);zV.ac(8);break}return h==="!*$_ALL_ENTITIES_!*$"?g.b(zV,Yp(P.W,v,P.G),8):g.b(zV,A1(h,"musicPlaylist",P.W,v,P.G),8);case 8:if(!k.length||!m&&k[0].playlistId!==h)return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));case 6:if(m){A=[];x=g.N(k);for(S=x.next();!S.done;S=x.next())B=S.value,B.upToDate||
f&&!B.shouldAutoSyncMetadata||!B.playlistId||(E={autoSync:f},A.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",B.playlistId,"musicPlaylist",0,VZ,{musicPlaylistEntityActionMetadata:E})));return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,A))}k.length&&(r=k[0],J=!!r.upToDate,f&&(w=(hq=r.shouldAutoSyncMetadata)!=null?hq:!0,I=(R7=r.shouldAutoSyncVideos)!=null?R7:!0,r.checkInSeconds&&(K=r.checkInSeconds)));if(J||!w)return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l));Pw=[];H=z[0];T=void 0;if(!H.downloadMetadata){zV.ac(15);break}return g.b(zV,V6(P.W,H.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:n=zV.K,T=Number((du=(W=n)==null?void 0:W.addedTimestampMillis)!=null?du:"0")/1E3;case 15:return g.NP(zV,17),g.b(zV,fEy(P,h,(K1=T)==null?void 0:K1.toString(),K),19);case 19:Pw=zV.K;g.uD(zV,18);break;case 17:f1=g.Kx(zV);if(!(f1 instanceof Error&&f1.message==="No data")){if(f1 instanceof Error&&f1.message==="Empty response body")h1(f1.message);else return Aq=
"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",MP="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",f1 instanceof g.KR&&f1.type==="QUOTA_EXCEEDED"&&(Aq="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",MP="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,Aq,MP));zV.ac(18);break}return g.b(zV,A1(h,"musicPlaylist",P.W,v,P.G),18);case 18:if(!I)return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l));lY=[];$3=new Map;if((c=Pw)==null?0:c.length)for(F=g.N(Pw),Y=F.next();!Y.done;Y=F.next())L=Y.value,X=L.offlineVideoData,lD=void 0,((lD=X)==null?0:lD.videoId)&&$3.set(X.videoId,X);zW=new Map;mD=[];if((G=H)==null?0:(Cx=G.tracks)==null?0:Cx.length)for($a=g.N(H.tracks),tq=$a.next();!tq.done;tq=$a.next())if(px=tq.value,go=g.Ct(px).entityId)$3.has(go)?(zW.set(go,$3.get(go)),$3.delete(go)):mD.push(go);kw=Number(((jx=v.actionMetadata)==null?void 0:jx.priority)||0)+1;Ey=g.N($3.entries());for(Z7=Ey.next();!Z7.done;Z7=
Ey.next())ya=Z7.value,St=g.N(ya),Wr=St.next().value,fU=St.next().value,ae=Wr,jw=fU,lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",ae,"musicTrack",kw,VZ,bw(v,jw)));Hi=g.N(zW.entries());for(NV=Hi.next();!NV.done;NV=Hi.next())gY=NV.value,p7=g.N(gY),gK=p7.next().value,L7=p7.next().value,BN=gK,iI=L7,lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",BN,"musicTrack",kw,VZ,bw(v,iI)));A4=g.N(mD);for(Vv=A4.next();!Vv.done;Vv=A4.next())E1=Vv.value,lY.push(So("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
E1,"musicTrack",0,VZ));return zV.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,lY))}})},w7o=function(P,v){var l,e;
return g.p(function(h){switch(h.W){case 1:return l=yZ(v),g.NP(h,2),e=g.Ct(v.entityKey).entityId,e==="!*$_ALL_ENTITIES_!*$"?g.b(h,Yp(P.W,v,P.G),5):g.b(h,A1(e,"musicPlaylist",P.W,v,P.G),6);case 6:return g.b(h,On1(P.W,v.entityKey),5);case 5:g.uD(h,3);break;case 2:return g.Kx(h),h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},fEy=function(P,v,l,e){var h,z,m;
return g.p(function(Q){switch(Q.W){case 1:return g.b(Q,T1A([v]),2);case 2:return h=Q.K,g.b(Q,$F3(P,h[0],l,e),3);case 3:return z=Q.K,m=Il(z.thumbnailDetails),g.b(Q,uw(m),4);case 4:return Q.return(h[0].videos)}})},$F3=function(P,v,l,e){var h,z,m,Q,t,y,C,f,k;
return g.p(function(w){return w.W==1?(h=v.playlistId,z=o1Q(v),m=z.q3,Q=z.o1,t=l?(Number(l)*1E3).toString():Date.now().toString(),y=v.lastModifiedTimestamp?(Number(v.lastModifiedTimestamp)*1E3).toString():"0",C={id:g.ft(h,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:Q,lastModifiedTimestampMillis:y,addedTimestampMillis:t,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},f={id:g.ft(h,"musicPlaylist"),title:v.title,playlistId:h,thumbnailDetails:v.thumbnail,visibility:IEy(v),trackCount:v.totalVideoCount,
tracks:m,downloadMetadata:C.id},e&&(((k=f)==null?0:k.entityMetadata)?f.entityMetadata.nextAutoRefreshIntervalSeconds=String(e):f&&(f.entityMetadata={nextAutoRefreshIntervalSeconds:String(e)})),g.b(w,Mv(P.W,{mode:"readwrite",V7:!0},function(I){var J=OQ(I,f,"musicPlaylist");I=OQ(I,C,"musicPlaylistDownloadMetadataEntity");return g.x6.all([J,I])}),2)):w.return(f)})},IEy=function(P){switch(P.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},DFY=function(P,v){this.W=P;
this.G=v},u3Y=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I;
return g.p(function(J){switch(J.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,z=g.a(v.actionMetadata,nko),g.NP(J,2),g.b(J,Nty(P,h,void 0,(m=z)==null?void 0:m.track,(Q=z)==null?void 0:Q.albumRelease),4);case 4:if((t=z)==null?0:t.playlistId){J.ac(5);break}return g.b(J,Wwy(P.W,v.entityKey),5);case 5:g.uD(J,3);break;case 2:return y=g.Kx(J),C="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",f="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",y instanceof g.KR&&y.type==="QUOTA_EXCEEDED"&&
(C="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",f="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),J.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,C,f));case 3:w=Number(((k=v.actionMetadata)==null?void 0:k.priority)||0)+1;var K=(K=g.a(v.actionMetadata,nko))?{playbackDataActionMetadata:{maximumDownloadQuality:K.maximumDownloadQuality}}:void 0;I=So("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",h,"playbackData",w,J8Q,K);return J.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l,[I]))}})},Krv=function(P,v){var l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K;
return g.p(function(q){switch(q.W){case 1:return l=yZ(v),e=g.Ct(v.entityKey),h=e.entityId,g.b(q,V6(P.W,v.entityKey,"musicTrack"),2);case 2:z=q.K;if(!z){m=void 0;q.ac(3);break}return g.b(q,V6(P.W,z.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:m=q.K;case 3:Q=m;if(!z||!Q)return q.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l));y=g.a(v.actionMetadata,nko);g.NP(q,5);return g.b(q,Nty(P,h,Q.addedTimestampMillis,(C=y)==null?void 0:C.track,(f=y)==null?void 0:f.albumRelease),
7);case 7:w=Number(((k=v.actionMetadata)==null?void 0:k.priority)||0)+1;t=So("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",h,"playbackData",w,J8Q);g.uD(q,6);break;case 5:I=g.Kx(q);if(!(I instanceof Error&&I.message==="No data")){if(I instanceof Error&&I.message==="Empty response body")h1(I.message);else return J="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",I instanceof g.KR&&I.type==="QUOTA_EXCEEDED"&&(J="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
K="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),q.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,J,K));q.ac(6);break}return g.b(q,FJ(h,P.W,v,P.G),6);case 6:return q.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",l,t?[t]:void 0))}})},c8y=function(P,v){var l,e;
return g.p(function(h){switch(h.W){case 1:return l=yZ(v),g.NP(h,2),e=g.Ct(v.entityKey).entityId,e==="!*$_ALL_ENTITIES_!*$"?g.b(h,Yp(P.W,v,P.G),5):g.b(h,FJ(e,P.W,v,P.G),6);case 6:return g.b(h,On1(P.W,v.entityKey),5);case 5:g.uD(h,3);break;case 2:return g.Kx(h),h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",l,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return h.return(new GC("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
l))}})},Nty=function(P,v,l,e,h){var z,m,Q,t,y,C;
return g.p(function(f){switch(f.W){case 1:if(z=e){f.ac(2);break}return g.b(f,M8b([v]),3);case 3:m=f.K,Q=m[0],z=E1Q(Q);case 2:return g.b(f,q7v(P,z,v,h,l),4);case 4:t=f.K;y=t.musicTrackEntity;C=t.Y1;var k=Il(y.thumbnailDetails),w=[];C&&(w=Il(C.thumbnailDetails));return g.b(f,uw(k.concat(w)),0)}})},q7v=function(P,v,l,e,h){var z;
return g.p(function(m){return m.W==1?(h||(h=Date.now().toString()),z={id:g.ft(l,"musicTrackDownloadMetadataEntity"),playbackData:g.ft(l,"playbackData"),addedTimestampMillis:h,videoDownloadContextEntity:g.ft(l,"videoDownloadContextEntity")},e&&(v.albumRelease=e.id),g.b(m,Mv(P.W,{mode:"readwrite",V7:!0},function(Q){var t=[],y=OQ(Q,z,"musicTrackDownloadMetadataEntity");t.push(y);y=OQ(Q,v,"musicTrack");t.push(y);e&&(Q=OQ(Q,e,"musicAlbumRelease"),t.push(Q));return g.x6.all(t)}),2)):m.W!=3?g.b(m,kp(l,"musicTrackDownloadMetadataEntity",
P.W,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):m.return({musicTrackEntity:v,
Y1:e})})},dv=function(){ol.apply(this,arguments);
this.X="musicTrack"},Fry=function(P,v,l){v=v===void 0?43200:v;
l=l===void 0?!0:l;var e=e===void 0?!1:e;var h,z;return g.p(function(m){switch(m.W){case 1:if(!P.T.GA())return m.return([]);h=[];g.NP(m,2);return g.b(m,e3o(v,l,e),4);case 4:h=m.K;g.uD(m,3);break;case 2:g.Kx(m);case 3:return z=Loy(P,h,l,"musicPlaylist"),m.return(z)}})},A8x=function(){g.x0.apply(this,arguments);
var P=this;this.events=new g.Z1(this);this.O$=this.player.N();this.Kh={Vq6:function(){return P.W},
bW:function(){return P.bW()},
hS:function(v){return P.hS(v)}}},Y7G=function(P){var v;
P=g.a((v=P.getWatchNextResponse())==null?void 0:v.currentVideoEndpoint,g.lV);if(P==null?0:P.playlistId)var l=P.playlistId;return l},bz1=function(P,v){var l,e,h,z;
return g.p(function(m){if(m.W==1){l=v.clientPlaybackNonce;e={cpn:l,offlineSourceVisualElement:g.Yt(v.kf||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};v.K&&(e.videoFmt=Number(v.K.itag));v.Y&&(e.audioFmt=Number(v.Y.itag));if((h=Y7G(v))&&v.videoId){var Q=v.videoId;Q=h!=="PPSV"?Promise.resolve(!1):P.W.SE(Q);m=g.b(m,Q,3)}else m=m.ac(2);return m}m.W!=2&&(z=m.K)&&(e.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");P.K=l;g.$6("offlinePlaybackStarted",e);g.nx(m)})};
g.b2.prototype.VX=g.e9(45,function(P){return this.app.VX(P)});
g.Km.prototype.VX=g.e9(44,function(P){return g.cy(this,9,P)});
g.D(i8,BD);g.Qw.Object.defineProperties(i8.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.W.entityMetadata},
set:function(P){this.W.entityMetadata=P}}});
g.D(F3v,i8);F3v.prototype.K=function(){return[]};
g.D(A4Y,i8);A4Y.prototype.K=function(){return[]};
g.D(Yto,i8);Yto.prototype.K=function(){return[]};
g.D(bIx,i8);bIx.prototype.K=function(){return[]};
g.D(xly,i8);xly.prototype.K=function(){var P=[];this.W.alternateChannel&&P.push(this.W.alternateChannel);this.W.alternateChannelList&&P.push.apply(P,g.u(this.W.alternateChannelList));this.W.oneofChannelEntity&&P.push(this.W.oneofChannelEntity);return[].concat(g.u(new Set(P)))};
g.D(p_o,i8);p_o.prototype.K=function(){var P=[];this.W.entryCollection&&P.push(this.W.entryCollection);return[].concat(g.u(new Set(P)))};
g.D(L3Y,BD);L3Y.prototype.K=function(){var P=[];this.W.video&&P.push(this.W.video);return[].concat(g.u(new Set(P)))};
g.D(Sty,i8);Sty.prototype.K=function(){var P=[];this.W.parentPlaylist&&P.push(this.W.parentPlaylist);if(this.W.entries)for(var v=g.N(this.W.entries),l=v.next();!l.done;l=v.next())P.push.apply(P,g.u((new L3Y(l.value)).K()));return[].concat(g.u(new Set(P)))};
g.D(G7x,i8);G7x.prototype.K=function(){var P=[];this.W.descriptionEntity&&P.push(this.W.descriptionEntity);this.W.creators&&P.push.apply(P,g.u(this.W.creators));this.W.theBiggestFan&&P.push(this.W.theBiggestFan);return[].concat(g.u(new Set(P)))};
g.D(X_y,i8);X_y.prototype.K=function(){return[]};
g.D(BF1,i8);BF1.prototype.K=function(){return[]};
g.D(iI1,i8);iI1.prototype.K=function(){return[]};
g.D(Ulm,i8);Ulm.prototype.K=function(){return[]};
g.D(ZIA,i8);ZIA.prototype.K=function(){return[]};
g.D(j3o,i8);j3o.prototype.K=function(){return[]};
g.D(aGy,i8);aGy.prototype.K=function(){return[]};
g.D(HIy,i8);HIy.prototype.K=function(){return[]};
g.D(Eu1,i8);Eu1.prototype.K=function(){return[]};
g.D(W3A,i8);W3A.prototype.K=function(){var P=[];this.W.downloadsList&&P.push(this.W.downloadsList);this.W.smartDownloadsList&&P.push(this.W.smartDownloadsList);this.W.recommendedDownloadsList&&P.push(this.W.recommendedDownloadsList);this.W.refresh&&P.push(this.W.refresh);return[].concat(g.u(new Set(P)))};
g.D(OIQ,BD);OIQ.prototype.K=function(){var P=[];this.W.video&&P.push(this.W.video);this.W.playlist&&P.push(this.W.playlist);this.W.videoItem&&P.push(this.W.videoItem);this.W.playlistItem&&P.push(this.W.playlistItem);return[].concat(g.u(new Set(P)))};
g.D(ou3,i8);ou3.prototype.K=function(){var P=[];this.W.refresh&&P.push(this.W.refresh);if(this.W.downloads)for(var v=g.N(this.W.downloads),l=v.next();!l.done;l=v.next())P.push.apply(P,g.u((new OIQ(l.value)).K()));return[].concat(g.u(new Set(P)))};
g.D(s31,i8);s31.prototype.K=function(){var P=[];this.W.localImageEntities&&P.push.apply(P,g.u(this.W.localImageEntities));return[].concat(g.u(new Set(P)))};
g.D(r43,i8);r43.prototype.K=function(){var P=[];this.W.playbackData&&P.push(this.W.playbackData);this.W.localImageEntities&&P.push.apply(P,g.u(this.W.localImageEntities));this.W.videoDownloadContextEntity&&P.push(this.W.videoDownloadContextEntity);return[].concat(g.u(new Set(P)))};
g.D(Mzj,i8);Mzj.prototype.K=function(){return[]};
g.D(TFo,i8);TFo.prototype.K=function(){var P=[];this.W.fakeChildren&&P.push.apply(P,g.u(this.W.fakeChildren));return[].concat(g.u(new Set(P)))};
g.D(Vzy,i8);Vzy.prototype.K=function(){var P=[];this.W.video&&P.push(this.W.video);this.W.playbackData&&P.push(this.W.playbackData);this.W.offlineVideoPolicy&&P.push(this.W.offlineVideoPolicy);return[].concat(g.u(new Set(P)))};
g.D(dlA,i8);dlA.prototype.K=function(){return[]};
g.D(PIm,i8);PIm.prototype.K=function(){var P=[];this.W.channelOwner&&P.push(this.W.channelOwner);this.W.videos&&P.push.apply(P,g.u(this.W.videos));this.W.collaboratorChannels&&P.push.apply(P,g.u(this.W.collaboratorChannels));this.W.downloadState&&P.push(this.W.downloadState);this.W.refresh&&P.push(this.W.refresh);return[].concat(g.u(new Set(P)))};
g.D(vYQ,i8);vYQ.prototype.K=function(){var P=[];this.W.video&&P.push(this.W.video);this.W.channelContributor&&P.push(this.W.channelContributor);return[].concat(g.u(new Set(P)))};
g.D(lA1,BD);lA1.prototype.K=function(){var P=[];this.W.localImageEntities&&P.push.apply(P,g.u(this.W.localImageEntities));this.W.videoDownloadContextEntity&&P.push(this.W.videoDownloadContextEntity);return[].concat(g.u(new Set(P)))};
g.D(eJd,BD);eJd.prototype.K=function(){var P=[];this.W.recommendedVideoMetadata&&P.push.apply(P,g.u((new lA1(this.W.recommendedVideoMetadata)).K()));return[].concat(g.u(new Set(P)))};
g.D(hJ1,BD);hJ1.prototype.K=function(){var P=[];this.W.playbackPosition&&P.push(this.W.playbackPosition);return[].concat(g.u(new Set(P)))};
g.D(zJv,i8);zJv.prototype.K=function(){var P=[];this.W.owner&&P.push(this.W.owner);this.W.downloadState&&P.push(this.W.downloadState);this.W.userState&&P.push.apply(P,g.u((new hJ1(this.W.userState)).K()));this.W.additionalMetadata&&P.push.apply(P,g.u((new eJd(this.W.additionalMetadata)).K()));return[].concat(g.u(new Set(P)))};
g.D(m$y,i8);m$y.prototype.K=function(){var P=[];this.W.userChannelDetails&&P.push(this.W.userChannelDetails);return[].concat(g.u(new Set(P)))};
g.D(RJm,i8);RJm.prototype.K=function(){var P=[];this.W.channelOwner&&P.push(this.W.channelOwner);this.W.playbackPosition&&P.push(this.W.playbackPosition);this.W.localImageEntities&&P.push.apply(P,g.u(this.W.localImageEntities));this.W.downloadStatus&&P.push(this.W.downloadStatus);return[].concat(g.u(new Set(P)))};
g.D(Q9v,i8);Q9v.prototype.K=function(){return[]};
g.D(tjx,i8);tjx.prototype.K=function(){return[]};
g.D(y7j,i8);y7j.prototype.K=function(){return[]};
g.D(CIA,i8);CIA.prototype.K=function(){return[]};
g.D(fA1,i8);fA1.prototype.K=function(){return[]};
g.D(gYA,i8);gYA.prototype.K=function(){return[]};
g.D(ktx,i8);ktx.prototype.K=function(){return[]};
g.D(wN3,i8);wN3.prototype.K=function(){return[]};
g.D($$3,i8);$$3.prototype.K=function(){return[]};
g.D(IAd,i8);IAd.prototype.K=function(){return[]};
g.D(D$o,i8);D$o.prototype.K=function(){return[]};
g.D(nYm,i8);nYm.prototype.K=function(){var P=[];this.W.trackDownloadMetadatas&&P.push.apply(P,g.u(this.W.trackDownloadMetadatas));return[].concat(g.u(new Set(P)))};
g.D(Nzo,i8);
Nzo.prototype.K=function(){var P=[];this.W.downloadedTracks&&P.push.apply(P,g.u(this.W.downloadedTracks));this.W.smartDownloadedTracks&&P.push.apply(P,g.u(this.W.smartDownloadedTracks));this.W.downloadedEpisodes&&P.push.apply(P,g.u(this.W.downloadedEpisodes));this.W.downloadedAlbumReleases&&P.push.apply(P,g.u(this.W.downloadedAlbumReleases));this.W.smartDownloadedAlbumReleases&&P.push.apply(P,g.u(this.W.smartDownloadedAlbumReleases));this.W.downloadedPlaylists&&P.push.apply(P,g.u(this.W.downloadedPlaylists));this.W.smartDownloadedPlaylists&&
P.push.apply(P,g.u(this.W.smartDownloadedPlaylists));this.W.metadataOnlyTracks&&P.push.apply(P,g.u(this.W.metadataOnlyTracks));return[].concat(g.u(new Set(P)))};
g.D(J7G,i8);J7G.prototype.K=function(){var P=[];this.W.trackDownloadMetadatas&&P.push.apply(P,g.u(this.W.trackDownloadMetadatas));return[].concat(g.u(new Set(P)))};
g.D(ujY,i8);ujY.prototype.K=function(){var P=[];this.W.playbackData&&P.push(this.W.playbackData);this.W.localImageEntities&&P.push.apply(P,g.u(this.W.localImageEntities));this.W.videoDownloadContextEntity&&P.push(this.W.videoDownloadContextEntity);return[].concat(g.u(new Set(P)))};
g.D(KWx,i8);KWx.prototype.K=function(){var P=[];this.W.musicLibraryStatusEntity&&P.push(this.W.musicLibraryStatusEntity);this.W.primaryArtists&&P.push.apply(P,g.u(this.W.primaryArtists));this.W.details&&P.push(this.W.details);this.W.userDetails&&P.push(this.W.userDetails);this.W.tracks&&P.push.apply(P,g.u(this.W.tracks));this.W.share&&P.push(this.W.share);this.W.downloadMetadata&&P.push(this.W.downloadMetadata);this.W.refresh&&P.push(this.W.refresh);return[].concat(g.u(new Set(P)))};
g.D(c7o,i8);c7o.prototype.K=function(){var P=[];this.W.albumRelease&&P.push(this.W.albumRelease);this.W.tracks&&P.push.apply(P,g.u(this.W.tracks));return[].concat(g.u(new Set(P)))};
g.D(q3A,i8);q3A.prototype.K=function(){var P=[];this.W.albumRelease&&P.push(this.W.albumRelease);return[].concat(g.u(new Set(P)))};
g.D(FWA,i8);FWA.prototype.K=function(){var P=[];this.W.details&&P.push(this.W.details);this.W.userDetails&&P.push(this.W.userDetails);return[].concat(g.u(new Set(P)))};
g.D(A7Y,i8);A7Y.prototype.K=function(){var P=[];this.W.parentArtist&&P.push(this.W.parentArtist);return[].concat(g.u(new Set(P)))};
g.D(Y3m,i8);Y3m.prototype.K=function(){var P=[];this.W.parentArtist&&P.push(this.W.parentArtist);return[].concat(g.u(new Set(P)))};
g.D(bJQ,i8);bJQ.prototype.K=function(){return[]};
g.D(x$A,i8);x$A.prototype.K=function(){return[]};
g.D(pN1,BD);pN1.prototype.K=function(){var P=[];this.W.creatorEntity&&P.push(this.W.creatorEntity);return[].concat(g.u(new Set(P)))};
g.D(LW3,i8);
LW3.prototype.K=function(){var P=[];this.W.tracks&&P.push.apply(P,g.u(this.W.tracks));this.W.refresh&&P.push(this.W.refresh);this.W.musicLibraryStatusEntity&&P.push(this.W.musicLibraryStatusEntity);this.W.details&&P.push(this.W.details);this.W.downloadMetadata&&P.push(this.W.downloadMetadata);this.W.sideloadMetadata&&P.push(this.W.sideloadMetadata);this.W.userDetails&&P.push(this.W.userDetails);this.W.entryCollection&&P.push(this.W.entryCollection);this.W.share&&P.push(this.W.share);this.W.podcastShowAdditionalMetadata&&P.push.apply(P,
g.u((new pN1(this.W.podcastShowAdditionalMetadata)).K()));return[].concat(g.u(new Set(P)))};
g.D(S3y,i8);S3y.prototype.K=function(){return[]};
g.D(GtG,i8);
GtG.prototype.K=function(){var P=[];this.W.musicLibraryStatusEntity&&P.push(this.W.musicLibraryStatusEntity);this.W.artists&&P.push.apply(P,g.u(this.W.artists));this.W.audioModeVersion&&P.push(this.W.audioModeVersion);this.W.videoModeVersion&&P.push(this.W.videoModeVersion);this.W.userDetails&&P.push(this.W.userDetails);this.W.details&&P.push(this.W.details);this.W.albumRelease&&P.push(this.W.albumRelease);this.W.share&&P.push(this.W.share);this.W.libraryEdit&&P.push(this.W.libraryEdit);this.W.downloadMetadata&&
P.push(this.W.downloadMetadata);this.W.playbackPosition&&P.push(this.W.playbackPosition);this.W.lyrics&&P.push(this.W.lyrics);return[].concat(g.u(new Set(P)))};
g.D(XNj,i8);XNj.prototype.K=function(){var P=[];this.W.parentTrack&&P.push(this.W.parentTrack);return[].concat(g.u(new Set(P)))};
g.D(Bzj,i8);Bzj.prototype.K=function(){var P=[];this.W.parentTrack&&P.push(this.W.parentTrack);return[].concat(g.u(new Set(P)))};
g.D(iJm,i8);iJm.prototype.K=function(){return[]};
g.D(U$x,i8);U$x.prototype.K=function(){return[]};
g.D(ZJG,i8);ZJG.prototype.K=function(){return[]};
g.D(j9m,i8);j9m.prototype.K=function(){return[]};
g.D(aAb,i8);aAb.prototype.K=function(){var P=[];this.W.transfer&&P.push(this.W.transfer);this.W.adsPlaybackData&&P.push.apply(P,g.u(this.W.adsPlaybackData));this.W.drmLicense&&P.push(this.W.drmLicense);this.W.offlineVideoPolicy&&P.push(this.W.offlineVideoPolicy);this.W.videoDownloadContextEntity&&P.push(this.W.videoDownloadContextEntity);return[].concat(g.u(new Set(P)))};
g.D(HJA,i8);HJA.prototype.K=function(){return[]};
g.D(EYy,i8);EYy.prototype.K=function(){var P=[];this.W.offlineVideoStreams&&P.push.apply(P,g.u(this.W.offlineVideoStreams));this.W.captionTrack&&P.push.apply(P,g.u(this.W.captionTrack));return[].concat(g.u(new Set(P)))};
g.D(WWo,i8);WWo.prototype.K=function(){return[]};
g.D(OJ3,i8);OJ3.prototype.K=function(){return[]};
g.D(oYy,i8);oYy.prototype.K=function(){return[]};
g.D(s9m,i8);s9m.prototype.K=function(){return[]};
g.D(r7d,i8);r7d.prototype.K=function(){return[]};
g.D(MjA,i8);MjA.prototype.K=function(){return[]};
g.D(Tzo,i8);Tzo.prototype.K=function(){return[]};
g.D(Vj1,i8);Vj1.prototype.K=function(){return[]};
g.D(d$y,i8);d$y.prototype.K=function(){return[]};
g.D(PLo,i8);PLo.prototype.K=function(){return[]};
g.D(v8A,i8);v8A.prototype.K=function(){return[]};
g.D(lDY,i8);lDY.prototype.K=function(){return[]};
g.D(eHd,i8);eHd.prototype.K=function(){return[]};
g.D(hHy,i8);hHy.prototype.K=function(){return[]};
g.D(zHj,i8);zHj.prototype.K=function(){return[]};
g.D(mL3,i8);mL3.prototype.K=function(){return[]};
g.D(RHj,i8);RHj.prototype.K=function(){return[]};
var h3Q=["browse","music/browse","unplugged/browse"],tZy=["offline/playlist_sync_check"],rvd=["offline"],z31=["offline/offline_video_playback_position_sync"],R3v=["offline/get_playback_data_entity"],UQ;Za.getInstance=function(){return g.p(function(P){return P.return(new Promise(function(v){g.zJ().then(function(l){l?(Za.instance||(Za.instance=new Za(l)),v(Za.instance)):v(void 0)})}))})};
Za.prototype.get=function(P){var v=this,l,e,h;return g.p(function(z){if(z.W==1)return g.b(z,CLG(v.token),2);if(z.W!=3)return l=z.K,g.b(z,l.get("prefs",P),3);e=z.K;if(!e)return z.return();h=(0,g.Gz)();return e.expirationTimestampMs<=h?z.return():z.return(e.value)})};
Za.prototype.set=function(P,v,l){l=l===void 0?31536E3:l;var e=this,h,z,m;return g.p(function(Q){if(Q.W==1)return h=(0,g.Gz)(),z={key:P,value:v,expirationTimestampMs:h+l*1E3},g.b(Q,CLG(e.token),2);m=Q.K;return g.b(Q,g.jY(m,"prefs",z),0)})};
Za.prototype.remove=function(P){var v=this,l;return g.p(function(e){if(e.W==1)return g.b(e,CLG(v.token),2);l=e.K;return g.b(e,l.delete("prefs",P),0)})};
g.D(jk,g.Ph);g.D(ax,$Lm);ax.prototype.G=function(P,v){v=DLv(v);P=(new TextEncoder).encode(JSON.stringify(P));return this.W.encrypt(P,v)};
ax.prototype.K=function(P,v){if(!(P instanceof Uint8Array))throw fDb(1);var l=new TextDecoder;v=DLv(v);P=this.W.decrypt(P,v);return JSON.parse(l.decode(P))};
var n83={accountLinkStatusEntity:iI1,booleanEntity:Yto,buttonEntity:PLo,captionTrack:iJm,channelHandle:F3v,commerceAcquisitionClientPayloadEntity:lDY,commerceCartListEntity:eHd,contextNoteFeedEntityPayload:A4Y,continuationTokenEntity:dlA,downloadQualityPickerEntity:aGy,downloadsPageRefreshTokenEntity:Eu1,downloadsPageViewConfigurationEntity:Q9v,downloadStatusEntity:HIy,sfvAudioItemCurrentlyPlayingEntity:OJ3,emojiFountainDataEntity:Vj1,emojiCustomizationSetEntity:Tzo,fakeChannel:xly,fakePlaylist:p_o,
fakePlaylistEntryCollection:Sty,fakeVideo:G7x,fakeVideoDescription:X_y,featuredProductsEntity:$$3,flowStateEntity:BF1,iconBadgeEntity:hHy,interstitialInteractionStateEntity:ZIA,likeButtonAnimationEntity:tjx,liveChatPollStateEntity:j3o,liveReactionsDataEntity:d$y,logoEntity:Ulm,macroMarkerEntity:y7j,mainDownloadsLibraryEntity:W3A,mainDownloadsListEntity:ou3,mainPlaylistDownloadStateEntity:s31,mainPlaylistEntity:PIm,mainPlaylistVideoEntity:vYQ,mainVideoDownloadStateEntity:r43,mainVideoEntity:zJv,markersEngagementPanelSyncEntity:CIA,
markersVisibilityOverrideEntity:fA1,musicAlbumReleaseDetail:c7o,musicAlbumReleaseDownloadMetadataEntity:nYm,musicAlbumRelease:KWx,musicAlbumReleaseUserDetail:q3A,musicArtistDetail:A7Y,musicArtist:FWA,musicArtistUserDetail:Y3m,musicDownloadsLibraryEntity:Nzo,musicLibraryEdit:bJQ,musicLibraryStatusEntity:x$A,musicPlaylist:LW3,musicPlaylistDownloadMetadataEntity:J7G,musicShare:S3y,musicTrackDetail:XNj,musicTrackDownloadMetadataEntity:ujY,musicTrack:GtG,musicTrackUserDetail:Bzj,offlineOrchestrationActionWrapperEntity:U$x,
offlineVideoPolicy:ZJG,offlineVideoStreams:j9m,offlineabilityEntity:Mzj,orchestrationWebSamplingEntity:TFo,pageHeaderEntity:r7d,pdpStateEntity:zHj,pinnedProductEntity:IAd,playbackData:aAb,playerStateEntity:gYA,quantityIncrementerEntity:mL3,refresh:HJA,saveToPlaylistListEntity:oYy,settingEntity:s9m,stringEntity:bIx,suggestedFeedbackChipStateEntity:ktx,transfer:EYy,trendingOfferEntity:D$o,videoDownloadContextEntity:WWo,videoOverviewAsyncDataEntity:RHj,videoPlaybackPositionEntity:v8A,votingEntity:MjA,
ytMainChannelEntity:m$y,youchatPendingResponseEntity:wN3,ytMainDownloadedVideoEntity:Vzy,ytMainVideoEntity:RJm};g.D(sQ,$Lm);sQ.prototype.G=function(P){return P};
sQ.prototype.K=function(P){if(P instanceof Uint8Array)throw fDb(0);return P};
g.D(r2,g.U);r2.prototype.observe=function(P){var v=this;this.observers.push(P);return function(){var l=v.observers.indexOf(P);l>=0&&v.observers.splice(l,1)}};
r2.prototype.K=function(P){SJA(this,P.data)};
r2.prototype.G1=function(){this.channel.close()};
var UL3,GUy=new g.Go("elementsCommand");var cc=new g.Go("entityBatchUpdate");var um1=new g.Go("downloadStatusEntity");var U7y=new g.Go("mainPlaylistEntityActionMetadata");var Mq=new g.Go("mainVideoEntityActionMetadata");var sFy=new g.Go("musicPlaylistEntityActionMetadata");var nko=new g.Go("musicTrackEntityActionMetadata");var P$m=new g.Go("localImageEntityActionMetadata");var XJ=new g.Go("playbackDataActionMetadata");var XLy=new g.Go("transferEntityActionMetadata");var NP3=new g.Go("videoPlaybackPositionEntityActionMetadata");var PBy;new g.J4;new g.J4;zim.prototype.request=function(P,v,l){v=v===void 0?{}:v;return this.locks.request(P,v,function(e){return l(e)})};var eo=g.Uy.caches,lw,yvy;vc.prototype.open=function(P){return eo.open(QFb(P))};
vc.prototype.has=function(P){return eo.has(QFb(P))};
vc.prototype.delete=function(P){return eo.delete(QFb(P))};
vc.prototype.match=function(P,v){var l=this,e,h,z,m,Q,t;return g.p(function(y){switch(y.W){case 1:return g.b(y,l.keys(),2);case 2:e=y.K,h=g.N(e),z=h.next();case 3:if(z.done){y.ac(5);break}m=z.value;return g.b(y,l.open(m),6);case 6:return Q=y.K,g.b(y,Q.match(P,v),7);case 7:if(t=y.K)return y.return(t);z=h.next();y.ac(3);break;case 5:return y.return()}})};
g.D(Rix,vc);Rix.prototype.keys=function(){var P,v,l,e,h,z,m,Q,t;return g.p(function(y){if(y.W==1)return P=[],v=g.vh("CacheStorage keys"),g.b(y,eo.keys(),2);l=y.K;e=g.N(l);for(h=e.next();!h.done;h=e.next()){z=h.value;var C=z.indexOf(":");m=C===-1?{zH:z}:{zH:z.substring(0,C),datasyncId:z.substring(C+1)};Q=m.zH;t=m.datasyncId;t===v&&P.push(Q)}return y.return(P)})};g.D(zC,g.U);zC.prototype.G=function(P){this.api.C0("onOfflineOperationFailure",P.data)};
zC.prototype.Y=function(P){this.api.publish("offlinetransferpause",P.data)};
zC.prototype.G1=function(){var P;(P=this.W)==null||P.close();var v;(v=this.K)==null||v.close()};g1y.prototype.Nv=function(){this.W&&Rl(this)};
g1y.prototype.Oz=function(){this.K&&this.K.resolve();this.G=this.W=!1;this.X()};var VZj=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var pkd="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var Hno="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.D(Cxy,LA);Cxy.prototype.K=function(P){return CA(P)?k2b(this,P):fA(P)?Ib1(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};g.D(DRA,LA);DRA.prototype.K=function(P){return fA(P)?ngd(this,P):JvA(P)?JJy(this,P):gv(P)?uax(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};g.R=KUm.prototype;g.R.KD3=function(P){var v=this,l,e,h,z;return g.p(function(m){if(!g.M(P.state,128))return m.ac(0);l=P.state.xF;var Q=(e=l)==null?void 0:e.errorCode,t=(h=l)==null?void 0:h.Nu;z=Q==="net.connect"&&t===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(Q==null?0:Q.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.b(m,v.Xl(v.player.getVideoData().videoId,z),0)})};
g.R.Xl=function(P,v){var l=this;return g.p(function(e){if(e.W==1){if(l.K)return e.return();l.K=!0;return v==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(Up(l,P,!1,!0),e.ac(0)):g.b(e,iw(l,P),3)}g.S0(P,4);return g.b(e,l.W.Xl(v),0)})};
g.R.Q$=function(P){P.status===2?(P.status!==this.G&&(nsv(this.W),g.S0(P.videoId,2)),P.Qi&&ca1(this.W,P.videoId,P.Qi)):P.status===4?(iw(this,P.videoId),this.Xl(P.videoId,P.eJ?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):P.status===1&&Kox(this.W);this.G=P.status;this.api.C0("localmediachange",{videoId:P.videoId,status:P.status})};
g.R.qS=function(){var P=this,v;return g.p(function(l){if(l.W==1){if(P.K)return l.return();P.K=!0;v=P.player.getVideoData().videoId;return g.b(l,iw(P,v),2)}return g.b(l,P.W.qS(),0)})};
g.R.F9=function(P){switch(P){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.R.V=function(P){return this.api.N().V(P)};g.D(xRy,LA);xRy.prototype.K=function(P){return CA(P)?LUo(this,P):fA(P)?Szy(this,P):JvA(P)?G2y(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};jAy.prototype.W=function(P,v){var l=P.action.actionMetadata.priority-v.action.actionMetadata.priority;l===0&&(P.W<v.W?l=-1:P.W>v.W&&(l=1));return l};g.D(ZK,g.U);ZK.prototype.G1=function(){this.X&&this.X();g.U.prototype.G1.call(this)};
ZK.prototype.createAction=function(P,v){var l=g.Ct(P.entityKey).entityType,e=g.YR(16);return new DK(l,e,P,v.actionId,v.rootActionId)};
ZK.prototype.QW=function(P){var v=this,l,e,h,z,m,Q,t,y,C;return g.p(function(f){if(f.W==1){if(v.s$())return f.return();e=(l=P.offlineOrchestrationActionWrapperEntity)!=null?l:new Set;h=[];z=g.N(e);for(m=z.next();!m.done;m=z.next())Q=m.value,t=g.Ct(Q),y=t.entityId,Egv(v.W,y)||h.push(Q);return g.b(f,vsQ(v,h),2)}C=f.K;return g.b(f,Pny(v,C),0)})};
ZK.prototype.retry=function(){var P=this;return g.p(function(v){return g.b(v,lq1(P),0)})};hvo.prototype.E_=function(P,v){v=v===void 0?!0:v;var l=this,e,h,z,m,Q,t,y,C;return g.p(function(f){switch(f.W){case 1:if(!l.W)return f.return();e=[];h=g.DR(l.W.K,v);z=[];for(m={bx:0};m.bx<h.length;m={bx:m.bx},m.bx++)Q=h[m.bx],t=l.W.o2(Q,"json3"),y=g.ia(t,{withCredentials:!0,format:"RAW"},3,500).then(function(k){return function(w){w={metadata:g.Dv(h[k.bx]),trackData:w.xhr.responseText};z.push(w)}}(m)).bY(function(k){h1("Caption fetch error",k)}),e.push(y);
return g.b(f,qtv(e),2);case 2:return g.NP(f,3),g.b(f,o8Y(P,z),5);case 5:g.uD(f,0);break;case 3:C=g.Kx(f),h1("Caption DB transaction error",C),g.nx(f)}})};g.D(jo,g.U);jo.prototype.G1=function(){this.K&&this.K();g.U.prototype.G1.call(this)};
jo.prototype.G=function(P){var v=this,l,e,h,z,m,Q,t,y;return g.p(function(C){e=(l=P.transfer)!=null?l:new Set;h=[];z=g.N(e);for(m=z.next();!m.done;m=z.next())Q=m.value,t=g.Ct(Q),y=t.entityId,h.push(y);return h.length===0?C.return():g.b(C,RvA(v,h),0)})};g.D(fqb,g.U);g.R=fqb.prototype;g.R.G1=function(){this.J5&&this.J5();this.T1.dispose();this.Y.dispose();this.Hg&&g.s1(this.T.gi,this.Hg);this.wM&&g.s1(this.T.gi,this.wM);g.U.prototype.G1.call(this)};
g.R.Evc=function(P){var v=this,l,e,h;return g.p(function(z){switch(z.W){case 1:l=g.ft(P,"transfer");if(v.W&&l===v.W.key){Up(v.j,v.Z,!0);v.Y.stop();z.ac(0);break}return g.b(z,Mv(v.K,{mode:"readwrite",V7:!0},function(m){return HD(m,l,"transfer").then(function(Q){if(Q&&Q.transferState!=="TRANSFER_STATE_COMPLETE"&&Q.transferState!=="TRANSFER_STATE_FAILED")return Q.transferState="TRANSFER_STATE_PAUSED_BY_USER",OQ(m,Q,"transfer").then(function(){return Q})})}),3);
case 3:e=z.K;if(!e){z.ac(0);break}if(!P||!v.G){z.ac(5);break}return g.b(z,kp(P,v.G,v.K,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.b(z,Ep(v,P),7);case 7:h=z.K,n1A({videoId:P,qj:e,offlineModeType:h}),g.nx(z)}})};
g.R.kQ$=function(){var P=this;if(this.W&&this.Z){Up(this.j,this.Z,!1);var v=this.W,l=(v==null?0:v.key)?g.Ct(v.key).entityId:"";l&&this.G&&(new Promise(function(e,h){kp(l,P.G,P.K,"DOWNLOAD_STATE_PAUSED").catch(function(z){h(z)})})).catch(function(e){h1("Download state setting error",e)})}this.Y.stop()};
g.R.Pt=function(){this.W?w9Q(this,this.W):Hc(this)};
g.R.e1=function(P){var v=this;return g.p(function(l){switch(l.W){case 1:if(!v.W){l.ac(2);break}if(v.W.transferState==="TRANSFER_STATE_COMPLETE"||v.W.transferState==="TRANSFER_STATE_FAILED"||!P.transfer||!P.transfer.has(v.W.key)){l.ac(3);break}return g.b(l,V6(v.K,v.W.key,"transfer"),4);case 4:v.W=l.K;if(v.W){l.ac(3);break}return g.b(l,$7G(v),3);case 3:if(v.W)return l.return();case 2:return g.b(l,Hc(v),0)}})};
g.R.Xl=function(P,v){var l=this,e,h,z,m,Q;return g.p(function(t){switch(t.W){case 1:if(!l.W){Wc(l,"onTransferFailure: "+P);t.ac(2);break}e=l.W;z=((h=e)==null?0:h.key)?g.Ct(e.key).entityId:"";a:switch(P){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var y=!1;break a;default:y=!0}return y&&qSb(l)?g.b(t,Op(l,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.b(t,
FoY(l,P),5);case 5:if(!z||!l.G){t.ac(2);break}return g.b(t,kp(z,l.G,l.K,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.b(t,Ep(l,z),9);case 9:m=t.K;t1({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:z,qj:e,offlineModeType:m});if(!z||!l.G){t.ac(2);break}return g.b(t,kp(z,l.G,l.K,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:al(l),Q=Hc(l,!0),v&&v(Q),g.nx(t)}})};
g.R.qS=function(P){var v=this,l,e,h,z,m,Q,t,y,C,f,k,w;return g.p(function(I){switch(I.W){case 1:if(!v.W){Wc(v,"onMaybeTransferStreamsExpired");I.ac(2);break}return qSb(v)?g.b(I,Op(v,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.b(I,FoY(v,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!v.G){I.ac(2);break}l=v.W;h=((e=l)==null?0:e.key)?g.Ct(l.key).entityId:"";if(!h){I.ac(2);break}return g.b(I,kp(h,v.G,v.K,"DOWNLOAD_STATE_FAILED"),2);case 9:return v.W||Wc(v,"onMaybeTransferStreamsExpiredRetryAttempting"),
z=v.W,Q=((m=z)==null?0:m.key)?g.Ct(z.key).entityId:"",g.b(I,Ep(v,Q),10);case 10:return t=I.K,t1({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:Q,qj:z,offlineModeType:t}),y=qmQ(),g.Oc(y,XJ,{isEnqueuedForExpiredStreamUrlRefetch:!0}),C=g.ft(Q,"playbackData"),f={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:C,actionMetadata:y},k=Nq(new DK("playbackData",Q,f)),g.b(I,Ts(v.K,k,"offlineOrchestrationActionWrapperEntity"),2);case 2:al(v),w=Hc(v,!0),
P&&P(w),g.nx(I)}})};
var xFY={},Aa3=(xFY.TRANSFER_STATE_TRANSFERRING=1,xFY.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,xFY);g.R=ol.prototype;g.R.Zz=function(){return this.Z.promise};
g.R.l0=function(){if(this.K&&this.j)return this.Z.promise;x71(this).then(this.Z.resolve).catch(this.Z.reject);return this.Z.promise};
g.R.Zv=function(P){var v={};return v.playbackData=new Cxy(P,this.O$,this.W),v.transfer=new xRy(P,this.O$),v.videoPlaybackPositionEntity=new DRA(P,this.O$),v};
g.R.X1=function(){var P=this;return g.p(function(v){return P.K?g.b(v,gsy(P.K),0):v.ac(0)})};
g.R.SU=function(){var P=this,v,l;return g.p(function(e){if(e.W==1)return P.K||P.j?g.b(e,P.Zz(),2):e.return();P.S!==void 0&&(g.Ft(P.S),P.S=void 0);P.Y!==void 0&&(g.Ft(P.Y),P.Y=void 0);(v=P.K)==null||v.dispose();P.K=void 0;(l=P.j)==null||l.dispose();P.j=void 0;P.api.C0("onOrchestrationLostLeader");P.Z=new g.J4;g.nx(e)})};
g.R.isOrchestrationLeader=function(){return this.G.W};
g.R.SE=function(){return g.p(function(P){return P.return(!1)})};
g.R.T4=function(P){var v=this.W;v.api.publish("offlinetransferpause",P);var l;(l=v.K)==null||l.postMessage(P)};
g.R.Pt=function(P){var v,l;return g.p(function(e){if(e.W==1)return g.b(e,Pc(),2);v=e.K;if(!v)return e.return();l=g.ft(P,"transfer");return g.b(e,Mv(v,{mode:"readwrite",V7:!0},function(h){var z=HD(h,l,"transfer"),m=HD(h,g.ft(P,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.x6.all([z,m]).then(function(Q){Q=g.N(Q);var t=Q.next().value;var y=Q.next().value;return t&&t.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(t.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",OQ(h,t,"transfer").then(function(){t1({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:P,qj:t,offlineModeType:y==null?void 0:y.offlineModeType});return g.x6.resolve(null)})):g.x6.resolve(null)})}),0)})};
g.R.IQ=function(P){P=P===void 0?43200:P;var v=this,l,e,h,z,m,Q,t,y;return g.p(function(C){if(C.W==1)return v.T.GA()?g.b(C,Pc(),2):C.return(p9Y());if(C.W!=3){l=C.K;if(!l)return C.return([]);e=Date.now()/1E3;return g.b(C,d2(l,"offlineVideoPolicy"),3)}h=C.K;z=[];m=g.N(h);for(Q=m.next();!Q.done;Q=m.next())t=Q.value,Number(t.lastUpdatedTimestampSeconds)+P<=e&&(y=g.Ct(t.key).entityId,z.push(y));return z.length?C.return(sp(v,z,v.X,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):C.return([])})};
g.R.deleteAll=function(){return sp(this,["!*$_ALL_ENTITIES_!*$"],this.X,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.R.refreshAllStaleEntities=function(P){var v=this;return g.p(function(l){return l.W==1?g.b(l,v.IQ(P),2):l.return(l.K)})};
g.R.setUpPositionSyncInterval=function(P){var v=this;this.Y!==void 0&&(g.Ft(this.Y),this.Y=void 0);var l=P!=null?P:864E5;this.Y=g.cM(function(){v.qY(l)},l)};
g.R.qY=function(P){var v=this,l,e,h,z,m,Q;return g.p(function(t){switch(t.W){case 1:return g.NP(t,2),g.b(t,Za.getInstance(),4);case 4:l=t.K;if(!l)throw Error("prefStorage is undefined");return g.b(t,l.get("psi"),5);case 5:e=t.K;z=((h=e)==null?0:h.b6)?Number(e.b6)/1E3:0;m=Date.now();if(!(z+P<=m)){t.ac(6);break}return g.b(t,sp(v,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.uD(t,0);break;case 2:Q=g.Kx(t),h1("Offline manager error",Q),
g.nx(t)}})};
g.R.Bc=function(){var P=this,v,l,e,h,z,m,Q;return g.p(function(t){if(t.W==1)return g.b(t,Pc(),2);if(t.W!=3)return(v=t.K)?g.b(t,d2(v,"transfer"),3):t.return([]);l=t.K;e=[];h=g.N(l);for(z=h.next();!z.done;z=h.next())m=z.value,m.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&m.key&&(Q=g.Ct(m.key).entityId,e.push(Q));return t.return(SSd(P,e))})};
g.R.RW=function(){return g.p(function(P){return P.return([])})};
g.R.hW=function(){return g.p(function(P){g.nx(P)})};
g.R.WY=function(){return g.p(function(P){g.nx(P)})};g.D(GRm,LA);GRm.prototype.K=function(P){return CA(P)?iTY(this,P):fA(P)?ZTx(this,P):gv(P)?jjY(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};
var rv=[10];g.D(OTv,LA);OTv.prototype.K=function(P){return CA(P)?rax(this,P):fA(P)?MFY(this,P):gv(P)?Tjm(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};
var sjy=[10];g.D(d7Y,LA);d7Y.prototype.K=function(P){return fA(P)?vkb(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};g.D(lEv,ol);g.R=lEv.prototype;g.R.Zv=function(P){var v=ol.prototype.Zv.call(this,P);v.mainVideoEntity=new OTv(P,this.O$,this.W);v.mainPlaylistEntity=new GRm(P,this.O$,this.W);v.mainDownloadsListEntity=new d7Y(P,this.O$,this.W);return v};
g.R.refreshAllStaleEntities=function(P,v){var l=this,e,h,z,m,Q,t,y,C,f,k,w;return g.p(function(I){switch(I.W){case 1:e=[];if(!l.O$.V("web_player_offline_playlist_auto_refresh")){I.ac(2);break}return g.b(I,eem(l,P,v),3);case 3:e=I.K;case 2:return g.b(I,Za.getInstance(),4);case 4:return h=I.K,g.b(I,(z=h)==null?void 0:z.get("sdois"),5);case 5:return m=I.K,g.b(I,(Q=h)==null?void 0:Q.get("lmqf"),6);case 6:t=I.K;if(!m){I.ac(7);break}C=e;f=C.concat;return g.b(I,hem(l,m,(y=t)!=null?y:"SD",P===0),8);case 8:e=
f.call(C,I.K);case 7:return k=e,w=k.concat,g.b(I,ol.prototype.refreshAllStaleEntities.call(l,P,v),9);case 9:return e=w.call(k,I.K),I.return(e)}})};
g.R.SE=function(P){var v,l,e,h,z,m,Q,t;return g.p(function(y){if(y.W==1)return g.b(y,Pc(),2);if(y.W!=3)return(v=y.K)?g.b(y,V6(v,g.BV,"mainDownloadsListEntity"),3):y.return(!1);l=y.K;if((e=l)==null?0:(h=e.downloads)==null?0:h.length)for(z=g.ft(P,"mainVideoEntity"),m=g.N(l.downloads),Q=m.next();!Q.done;Q=m.next())if(t=Q.value,t.videoItem===z)return y.return(!0);return y.return(!1)})};
g.R.RW=function(){var P=this,v,l,e,h,z,m,Q,t;return g.p(function(y){if(y.W==1)return g.b(y,Pc(),2);if(y.W!=3)return(v=y.K)?g.b(y,d2(v,"downloadStatusEntity"),3):y.return([]);l=y.K;e=[];h=g.N(l);for(z=h.next();!z.done;z=h.next())m=z.value,m.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&m.key&&(Q=g.Ct(m.key).entityId,e.push(Q));return e.length?(t={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},y.return(sp(P,e,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
t))):y.return([])})};
g.R.WY=function(){var P;return g.p(function(v){return v.W==1?g.b(v,Pc(),2):(P=v.K)?g.b(v,Mv(P,{mode:"readwrite",V7:!0},function(l){return EQ(l,"mainVideoEntity").then(function(e){var h=[];e=g.N(e);for(var z=e.next();!z.done;z=e.next()){z=z.value;var m=void 0;(m=z.userState)!=null&&m.playbackPosition||(m=g.Ct(z.key).entityId,m={key:g.ft(m,"videoPlaybackPositionEntity"),videoId:m,lastPlaybackPositionSeconds:"0"},h.push(OQ(l,m,"videoPlaybackPositionEntity")),z.userState={playbackPosition:m.key},h.push(OQ(l,
z,"mainVideoEntity")))}return g.x6.all(h)})}),0):v.return()})};
g.R.hW=function(){var P,v,l,e,h,z,m,Q,t,y,C,f,k,w,I,J,K,q,A,x,S,B,E,r,hq,R7,Pw,H,T,n,W,du,K1,f1,Aq,MP,lY,$3;return g.p(function(c){if(c.W==1)return g.b(c,Pc(),2);if(c.W!=3){P=c.K;if(!P)return c.return();v=g.ft("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.b(c,Mv(P,{mode:"readonly",V7:!0},function(F){return g.x6.all([HD(F,v,"mainDownloadsListEntity"),HD(F,g.BV,"mainDownloadsListEntity"),EQ(F,"mainVideoEntity"),EQ(F,"mainPlaylistEntity")])}),3)}l=c.K;
e=g.N(l);h=e.next().value;z=e.next().value;m=e.next().value;Q=e.next().value;t=h;y=z;C=m;f=Q;k=new Set;if((w=t)==null?0:(I=w.downloads)==null?0:I.length)for(J=g.N(t.downloads),K=J.next();!K.done;K=J.next())q=K.value,A=void 0,(x=(A=q.videoItem)!=null?A:q.playlistItem)&&k.add(x);if((S=y)==null?0:(B=S.downloads)==null?0:B.length)for(E=g.N(y.downloads),r=E.next();!r.done;r=E.next())hq=r.value,hq.videoItem&&k.add(hq.videoItem);R7=new Set;Pw=[];H=g.N(f);for(T=H.next();!T.done;T=H.next()){n=T.value;if(n.videos)for(W=
g.N(n.videos),du=W.next();!du.done;du=W.next())K1=du.value,(f1=JSON.parse(g.Ct(K1).entityId).videoId)&&R7.add(f1);n.key&&!k.has(n.key)&&Pw.push(n.key)}Aq=g.N(C);for(MP=Aq.next();!MP.done;MP=Aq.next())lY=MP.value,lY.key&&!k.has(lY.key)&&($3=g.Ct(lY.key).entityId,R7.has($3)||Pw.push(lY.key));return Pw.length?g.b(c,U_Y(P,Pw),0):c.ac(0)})};g.D(zeY,LA);zeY.prototype.K=function(P){return CA(P)?Red(this,P):fA(P)?QXy(this,P):gv(P)?tdQ(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};
var TC=[10];g.D(C$b,LA);C$b.prototype.K=function(P){return CA(P)?gky(this,P):fA(P)?klv(this,P):gv(P)?w7o(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};
var VZ=[10];g.D(DFY,LA);DFY.prototype.K=function(P){return CA(P)?u3Y(this,P):fA(P)?Krv(this,P):gv(P)?c8y(this,P):Promise.reject(Error("Unsupported action type: "+P.actionType))};
var J8Q=[10];g.D(dv,ol);dv.prototype.Zv=function(P){var v=ol.prototype.Zv.call(this,P);v.musicTrack=new DFY(P,this.W);v.musicPlaylist=new C$b(P,this.W);v.musicAlbumRelease=new zeY(P,this.W);return v};
dv.prototype.refreshAllStaleEntities=function(P,v){var l=this,e,h,z;return g.p(function(m){if(m.W==1)return g.b(m,Fry(l,P,v),2);if(m.W!=3)return h=e=m.K,z=h.concat,g.b(m,ol.prototype.refreshAllStaleEntities.call(l,P,v),3);e=z.call(h,m.K);return m.return(e)})};g.D(A8x,g.x0);g.R=A8x.prototype;g.R.create=function(){var P=this;g.Z(this,this.events);g.Po(this.O$)?this.W=new lEv(this.O$,this.player):g.H$(this.O$)&&(this.W=new dv(this.O$,this.player));this.events.C(this.player,"onPlaybackStartExternal",function(){P.bW()});
this.events.C(this.player,"videodatachange",function(){P.bW()});
this.O$.V("html5_offline_playback_position_sync")&&this.events.C(this.player,"presentingplayerstatechange",this.hS)};
g.R.x9=function(){return!1};
g.R.Lu=function(P,v,l,e){var h=this;return g.p(function(z){return h.W?z.return(sp(h.W,P,v,l,e)):z.return(Promise.reject())})};
g.R.deleteAll=function(){return this.W.deleteAll()};
g.R.IQ=function(P){return this.W.IQ(P)};
g.R.refreshAllStaleEntities=function(P){return this.W.refreshAllStaleEntities(P)};
g.R.setUpPositionSyncInterval=function(P){this.W.setUpPositionSyncInterval(P)};
g.R.T4=function(P){this.W.T4(P)};
g.R.Pt=function(P){return this.W.Pt(P)};
g.R.bW=function(){var P=this,v;return g.p(function(l){v=P.player.getVideoData();return g.vS(v)?Y7G(v)&&P.K!==v.clientPlaybackNonce?g.b(l,bz1(P,v),0):l.ac(0):l.return()})};
g.R.hS=function(P){var v=this,l,e,h,z,m,Q,t;return g.p(function(y){if(y.W==1)return l=v.player.getVideoData(),e=l.sR,g.NQ(P,2)||g.NQ(P,512)?g.b(y,Pc(),2):y.return();if(y.W!=3){h=y.K;if(!h)return h1("PES is undefined"),y.return();z=l.videoId;return g.b(y,V6(h,g.ft(z,"mainVideoEntity"),"mainVideoEntity"),3)}m=y.K;if(!m)return y.return();Q=Math.floor(e).toString();t={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:Q}};return g.b(y,v.Lu([z],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
t),0)})};
g.R.isOrchestrationLeader=function(){return this.W.isOrchestrationLeader()};
g.R.updateDownloadState=function(P,v){var l,e,h,z;return g.p(function(m){if(m.W==1)return g.b(m,Pc(),2);l=m.K;if(!l)return h1("PES is undefined"),m.return();e=g.Ct(P);h=e.entityType;z=e.entityId;return g.b(m,kp(z,h,l,v,!0),0)})};g.br("offline",A8x);})(_yt_player);
